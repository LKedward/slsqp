<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="Modern Fortran Implementation of the SLSQP Optimization Method">
    
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>slsqpb &ndash; slsqp</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">slsqp </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">
              
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
				
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>slsqpb
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title="14.4% of total for procedures.">253 statements</a>
     </li> 
     
     
    <li><i class="fa fa-code"></i><a href="../src/slsqp_core.f90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/slsqp_core.f90.html'>slsqp_core.f90</a></li>
  
     <li><a href='../module/slsqp_core.html'>slsqp_core</a></li>
  
     <li class="active">slsqpb</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  




















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/slsqpb.html#src">slsqpb</a>
  </div>
</div>


  <hr>
  

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprocs-0">All Procedures</a></h3></div>
  <div id="allprocs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/daxpy.html">daxpy</a>
      
      <a class="list-group-item" href="../proc/dcopy.html">dcopy</a>
      
      <a class="list-group-item" href="../proc/ddot.html">ddot</a>
      
      <a class="list-group-item" href="../proc/destroy_linmin_data.html">destroy_linmin_data</a>
      
      <a class="list-group-item" href="../proc/destroy_slsqp.html">destroy_slsqp</a>
      
      <a class="list-group-item" href="../proc/destroy_slsqpb_data.html">destroy_slsqpb_data</a>
      
      <a class="list-group-item" href="../proc/diff.html">diff</a>
      
      <a class="list-group-item" href="../proc/dnrm2.html">dnrm2</a>
      
      <a class="list-group-item" href="../proc/dscal.html">dscal</a>
      
      <a class="list-group-item" href="../proc/dummy_grad.html">dummy_grad</a>
      
      <a class="list-group-item" href="../proc/enforce_bounds.html">enforce_bounds</a>
      
      <a class="list-group-item" href="../proc/g1.html">g1</a>
      
      <a class="list-group-item" href="../proc/h12.html">h12</a>
      
      <a class="list-group-item" href="../proc/hfti.html">hfti</a>
      
      <a class="list-group-item" href="../proc/initialize_slsqp.html">initialize_slsqp</a>
      
      <a class="list-group-item" href="../proc/ldl.html">ldl</a>
      
      <a class="list-group-item" href="../proc/ldp.html">ldp</a>
      
      <a class="list-group-item" href="../proc/linmin.html">linmin</a>
      
      <a class="list-group-item" href="../proc/lsei.html">lsei</a>
      
      <a class="list-group-item" href="../proc/lsi.html">lsi</a>
      
      <a class="list-group-item" href="../proc/lsq.html">lsq</a>
      
      <a class="list-group-item" href="../proc/mode_to_status_message.html">mode_to_status_message</a>
      
      <a class="list-group-item" href="../proc/nnls.html">nnls</a>
      
      <a class="list-group-item" href="../proc/report_iteration.html">report_iteration</a>
      
      <a class="list-group-item" href="../proc/report_iteration%7E2.html">report_iteration</a>
      
      <a class="list-group-item" href="../proc/report_iteration%7E3.html">report_iteration</a>
      
      <a class="list-group-item" href="../proc/report_message.html">report_message</a>
      
      <a class="list-group-item" href="../proc/rosenbrock_func.html">rosenbrock_func</a>
      
      <a class="list-group-item" href="../proc/rosenbrock_func%7E2.html">rosenbrock_func</a>
      
      <a class="list-group-item" href="../proc/rosenbrock_grad.html">rosenbrock_grad</a>
      
      <a class="list-group-item" href="../proc/slsqp.html">slsqp</a>
      
      <a class="list-group-item" href="../proc/slsqp_wrapper.html">slsqp_wrapper</a>
      
      <a class="list-group-item" href="../proc/slsqpb.html">slsqpb</a>
      
      <a class="list-group-item" href="../proc/stop_iterations.html">stop_iterations</a>
      
      <a class="list-group-item" href="../proc/test_func.html">test_func</a>
      
      <a class="list-group-item" href="../proc/test_grad.html">test_grad</a>
      
    </div>
  </div>
</div>


</div>  

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
private subroutine slsqpb(m, meq, la, n, x, xl, xu, f, c, g, a, acc, iter, mode, r, l, x0, mu, s, u, v, w, iw, t, f0, h1, h2, h3, h4, n1, n2, n3, t0, gs, tol, line, alpha, iexact, incons, ireset, itermx, ldat, alphamin, alphamax)
    
    
	 
</h2>
    
  


    
    <p>nonlinear programming by solving sequentially quadratic programs</p>
<p>l1 - line search, positive definite bfgs update</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-m%7E6"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>m</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-meq%7E4"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>meq</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-la%7E2"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>la</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n%7E9"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-x%7E9"></span>real(kind=wp),</td>
  <td></td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>x</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xl%7E4"></span>real(kind=wp),</td>
  <td></td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>xl</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xu%7E4"></span>real(kind=wp),</td>
  <td></td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>xu</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f%7E7"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>f</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-c%7E4"></span>real(kind=wp),</td>
  <td></td>
  <td></td>
  
  <td>dimension(la)</td><td>::</td>
  <td><strong>c</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-g%7E5"></span>real(kind=wp),</td>
  <td></td>
  <td></td>
  
  <td>dimension(n+1)</td><td>::</td>
  <td><strong>g</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-a%7E5"></span>real(kind=wp),</td>
  <td></td>
  <td></td>
  
  <td>dimension(la,n+1)</td><td>::</td>
  <td><strong>a</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-acc%7E4"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>acc</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iter%7E3"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iter</strong></td><td><p><strong>in:</strong>  maximum number of iterations.
 <strong>out:</strong> actual number of iterations.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mode%7E3"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>mode</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-r%7E3"></span>real(kind=wp),</td>
  <td></td>
  <td></td>
  
  <td>dimension(m+n+n+2)</td><td>::</td>
  <td><strong>r</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-l"></span>real(kind=wp),</td>
  <td></td>
  <td></td>
  
  <td>dimension((n+1)*(n+2)/2)</td><td>::</td>
  <td><strong>l</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-x0"></span>real(kind=wp),</td>
  <td></td>
  <td></td>
  
  <td>dimension(n)</td><td>::</td>
  <td><strong>x0</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mu"></span>real(kind=wp),</td>
  <td></td>
  <td></td>
  
  <td>dimension(la)</td><td>::</td>
  <td><strong>mu</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-s"></span>real(kind=wp),</td>
  <td></td>
  <td></td>
  
  <td>dimension(n+1)</td><td>::</td>
  <td><strong>s</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-u%7E4"></span>real(kind=wp),</td>
  <td></td>
  <td></td>
  
  <td>dimension(n+1)</td><td>::</td>
  <td><strong>u</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-v%7E4"></span>real(kind=wp),</td>
  <td></td>
  <td></td>
  
  <td>dimension(n+1)</td><td>::</td>
  <td><strong>v</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-w%7E5"></span>real(kind=wp),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>w</strong></td><td><p><code>dim(w)</code> =</p>
<ul>
<li><code>n1*(n1+1) + meq*(n1+1) + mineq*(n1+1)</code>   for <a href="../proc/lsq.html">lsq</a></li>
<li><code>+(n1-meq+1)*(mineq+2) + 2*mineq</code>         for <a href="../proc/lsi.html">lsi</a></li>
<li><code>+(n1+mineq)*(n1-meq) + 2*meq + n1</code>       for <a href="../proc/lsei.html">lsei</a></li>
</ul>
<p>with <code>mineq = m - meq + 2*n1</code> &amp; <code>n1 = n+1</code></p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iw"></span>integer,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(*)</td><td>::</td>
  <td><strong>iw</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>t</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f0%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>f0</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-h1%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>h1</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-h2%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>h2</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-h3%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>h3</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-h4%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>h4</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n1%7E2"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n1</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n2%7E2"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n2</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n3%7E2"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n3</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t0%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>t0</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-gs%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>gs</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tol%7E3"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>tol</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-line%7E2"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>line</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-alpha%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>alpha</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iexact%7E2"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iexact</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-incons%7E2"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>incons</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ireset%7E2"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ireset</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-itermx%7E2"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>itermx</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ldat%7E2"></span>type(<a href='../type/linmin_data.html'>linmin_data</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ldat</strong></td><td><p>data for <a href="../proc/linmin.html">linmin</a>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-alphamin%7E4"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>alphamin</strong></td><td><p>min \( \alpha \) for line search \( 0 &lt; \alpha_{min} &lt; \alpha_{max} \le 1 \)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-alphamax%7E4"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>alphamax</strong></td><td><p>max \( \alpha \) for line search \( 0 &lt; \alpha_{min} &lt; \alpha_{max} \le 1 \)</p></td>
  
</tr>

</tbody>
</table>

    
    
    
     <h3>Calls</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~slsqpb~~CallsGraph Pages: 1 -->
<svg id="procslsqpbCallsGraph" width="638pt" height="638pt"
 viewBox="0.00 0.00 638.00 638.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~slsqpb~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 634)">
<title>proc~~slsqpb~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-634 634,-634 634,4 -4,4"/>
<!-- proc~slsqpb -->
<g id="proc~~slsqpb~~CallsGraph_node1" class="node"><title>proc~slsqpb</title>
<polygon fill="none" stroke="black" points="54,-236 0,-236 0,-212 54,-212 54,-236"/>
<text text-anchor="middle" x="27" y="-221.6" font-family="Helvetica,sans-Serif" font-size="10.50">slsqpb</text>
</g>
<!-- proc~dcopy -->
<g id="proc~~slsqpb~~CallsGraph_node2" class="node"><title>proc~dcopy</title>
<g id="a_proc~~slsqpb~~CallsGraph_node2"><a xlink:href="../proc/dcopy.html" xlink:title="dcopy">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-585 486,-585 486,-561 540,-561 540,-585"/>
<text text-anchor="middle" x="513" y="-570.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcopy</text>
</a>
</g>
</g>
<!-- proc~slsqpb&#45;&gt;proc~dcopy -->
<g id="proc~~slsqpb~~CallsGraph_edge28" class="edge"><title>proc~slsqpb&#45;&gt;proc~dcopy</title>
<path fill="none" stroke="#000000" d="M28.0914,-236.151C29.289,-303.704 44.3705,-630 224,-630 224,-630 224,-630 334,-630 387.388,-630 445.676,-606.455 480.514,-589.63"/>
<polygon fill="#000000" stroke="#000000" points="482.283,-592.66 489.694,-585.088 479.179,-586.386 482.283,-592.66"/>
</g>
<!-- proc~daxpy -->
<g id="proc~~slsqpb~~CallsGraph_node3" class="node"><title>proc~daxpy</title>
<g id="a_proc~~slsqpb~~CallsGraph_node3"><a xlink:href="../proc/daxpy.html" xlink:title="daxpy">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-334 486,-334 486,-310 540,-310 540,-334"/>
<text text-anchor="middle" x="513" y="-319.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">daxpy</text>
</a>
</g>
</g>
<!-- proc~slsqpb&#45;&gt;proc~daxpy -->
<g id="proc~~slsqpb~~CallsGraph_edge29" class="edge"><title>proc~slsqpb&#45;&gt;proc~daxpy</title>
<path fill="none" stroke="#000000" d="M54.165,-216.447C98.9651,-204.68 192.983,-185.088 270,-203 354.508,-222.654 443.481,-276.213 486.17,-304.289"/>
<polygon fill="#000000" stroke="#000000" points="484.294,-307.246 494.558,-309.873 488.173,-301.418 484.294,-307.246"/>
</g>
<!-- proc~linmin -->
<g id="proc~~slsqpb~~CallsGraph_node4" class="node"><title>proc~linmin</title>
<g id="a_proc~~slsqpb~~CallsGraph_node4"><a xlink:href="../proc/linmin.html" xlink:title="linmin">
<polygon fill="#d94e8f" stroke="#d94e8f" points="144,-66 90,-66 90,-42 144,-42 144,-66"/>
<text text-anchor="middle" x="117" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linmin</text>
</a>
</g>
</g>
<!-- proc~slsqpb&#45;&gt;proc~linmin -->
<g id="proc~~slsqpb~~CallsGraph_edge30" class="edge"><title>proc~slsqpb&#45;&gt;proc~linmin</title>
<path fill="none" stroke="#000000" d="M31.5655,-211.651C39.4114,-185.729 59.9014,-124.377 90,-80 91.4736,-77.8273 93.1447,-75.6818 94.9119,-73.6106"/>
<polygon fill="#000000" stroke="#000000" points="97.6835,-75.7726 101.989,-66.0919 92.5862,-70.975 97.6835,-75.7726"/>
</g>
<!-- proc~lsq -->
<g id="proc~~slsqpb~~CallsGraph_node5" class="node"><title>proc~lsq</title>
<g id="a_proc~~slsqpb~~CallsGraph_node5"><a xlink:href="../proc/lsq.html" xlink:title="lsq">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-317 90,-317 90,-293 144,-293 144,-317"/>
<text text-anchor="middle" x="117" y="-302.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lsq</text>
</a>
</g>
</g>
<!-- proc~slsqpb&#45;&gt;proc~lsq -->
<g id="proc~~slsqpb~~CallsGraph_edge31" class="edge"><title>proc~slsqpb&#45;&gt;proc~lsq</title>
<path fill="none" stroke="#000000" d="M41.3653,-236.302C55.662,-249.462 78.5252,-270.506 95.183,-285.839"/>
<polygon fill="#000000" stroke="#000000" points="93.0692,-288.65 102.797,-292.847 97.8099,-283.5 93.0692,-288.65"/>
</g>
<!-- proc~dscal -->
<g id="proc~~slsqpb~~CallsGraph_node6" class="node"><title>proc~dscal</title>
<g id="a_proc~~slsqpb~~CallsGraph_node6"><a xlink:href="../proc/dscal.html" xlink:title="dscal">
<polygon fill="#d9534f" stroke="#d9534f" points="252,-278 198,-278 198,-254 252,-254 252,-278"/>
<text text-anchor="middle" x="225" y="-263.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dscal</text>
</a>
</g>
</g>
<!-- proc~slsqpb&#45;&gt;proc~dscal -->
<g id="proc~~slsqpb~~CallsGraph_edge32" class="edge"><title>proc~slsqpb&#45;&gt;proc~dscal</title>
<path fill="none" stroke="#000000" d="M54.2252,-230.02C65.2618,-232.528 78.2464,-235.445 90,-238 123.009,-245.175 160.67,-253.014 187.643,-258.568"/>
<polygon fill="#000000" stroke="#000000" points="187.283,-262.067 197.783,-260.652 188.693,-255.21 187.283,-262.067"/>
</g>
<!-- proc~enforce_bounds -->
<g id="proc~~slsqpb~~CallsGraph_node7" class="node"><title>proc~enforce_bounds</title>
<g id="a_proc~~slsqpb~~CallsGraph_node7"><a xlink:href="../proc/enforce_bounds.html" xlink:title="enforce_bounds">
<polygon fill="#d9534f" stroke="#d9534f" points="270,-236 180,-236 180,-212 270,-212 270,-236"/>
<text text-anchor="middle" x="225" y="-221.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">enforce_bounds</text>
</a>
</g>
</g>
<!-- proc~slsqpb&#45;&gt;proc~enforce_bounds -->
<g id="proc~~slsqpb~~CallsGraph_edge33" class="edge"><title>proc~slsqpb&#45;&gt;proc~enforce_bounds</title>
<path fill="none" stroke="#000000" d="M54.0273,-224C83.3438,-224 131.812,-224 169.506,-224"/>
<polygon fill="#000000" stroke="#000000" points="169.827,-227.5 179.827,-224 169.827,-220.5 169.827,-227.5"/>
</g>
<!-- proc~ldl -->
<g id="proc~~slsqpb~~CallsGraph_node8" class="node"><title>proc~ldl</title>
<g id="a_proc~~slsqpb~~CallsGraph_node8"><a xlink:href="../proc/ldl.html" xlink:title="ldl">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-24 90,-24 90,-0 144,-0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ldl</text>
</a>
</g>
</g>
<!-- proc~slsqpb&#45;&gt;proc~ldl -->
<g id="proc~~slsqpb~~CallsGraph_edge34" class="edge"><title>proc~slsqpb&#45;&gt;proc~ldl</title>
<path fill="none" stroke="#000000" d="M29.5129,-211.759C33.9524,-179.789 49.2929,-92.1669 90,-33 90.3494,-32.4921 90.7147,-31.9902 91.0937,-31.4946"/>
<polygon fill="#000000" stroke="#000000" points="93.7887,-33.7398 98.1472,-24.0829 88.7179,-28.9141 93.7887,-33.7398"/>
</g>
<!-- proc~dnrm2 -->
<g id="proc~~slsqpb~~CallsGraph_node9" class="node"><title>proc~dnrm2</title>
<g id="a_proc~~slsqpb~~CallsGraph_node9"><a xlink:href="../proc/dnrm2.html" xlink:title="dnrm2">
<polygon fill="#d94e8f" stroke="#d94e8f" points="540,-456 486,-456 486,-432 540,-432 540,-456"/>
<text text-anchor="middle" x="513" y="-441.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dnrm2</text>
</a>
</g>
</g>
<!-- proc~slsqpb&#45;&gt;proc~dnrm2 -->
<g id="proc~~slsqpb~~CallsGraph_edge35" class="edge"><title>proc~slsqpb&#45;&gt;proc~dnrm2</title>
<path fill="none" stroke="#000000" d="M32.6328,-236.292C41.0855,-257.249 60.866,-300.134 90,-326 203.38,-426.661 395.995,-442.108 475.754,-444.012"/>
<polygon fill="#000000" stroke="#000000" points="475.735,-447.513 485.797,-444.194 475.861,-440.514 475.735,-447.513"/>
</g>
<!-- proc~ddot -->
<g id="proc~~slsqpb~~CallsGraph_node10" class="node"><title>proc~ddot</title>
<g id="a_proc~~slsqpb~~CallsGraph_node10"><a xlink:href="../proc/ddot.html" xlink:title="ddot">
<polygon fill="#d94e8f" stroke="#d94e8f" points="540,-182 486,-182 486,-158 540,-158 540,-182"/>
<text text-anchor="middle" x="513" y="-167.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ddot</text>
</a>
</g>
</g>
<!-- proc~slsqpb&#45;&gt;proc~ddot -->
<g id="proc~~slsqpb~~CallsGraph_edge36" class="edge"><title>proc~slsqpb&#45;&gt;proc~ddot</title>
<path fill="none" stroke="#000000" d="M37.5035,-211.535C63.4942,-178.997 139.477,-94 224,-94 224,-94 224,-94 334,-94 392.664,-94 454.099,-129.347 487.242,-151.829"/>
<polygon fill="#000000" stroke="#000000" points="485.605,-154.954 495.814,-157.789 489.601,-149.207 485.605,-154.954"/>
</g>
<!-- proc~lsq&#45;&gt;proc~dcopy -->
<g id="proc~~slsqpb~~CallsGraph_edge25" class="edge"><title>proc~lsq&#45;&gt;proc~dcopy</title>
<path fill="none" stroke="#000000" d="M129.404,-317.404C141.491,-330.306 161.37,-350.842 180,-367 270.654,-445.624 290.864,-471.151 396,-529 421.594,-543.083 452.627,-554.593 476.153,-562.305"/>
<polygon fill="#000000" stroke="#000000" points="475.147,-565.657 485.738,-565.373 477.281,-558.991 475.147,-565.657"/>
</g>
<!-- proc~lsq&#45;&gt;proc~dscal -->
<g id="proc~~slsqpb~~CallsGraph_edge23" class="edge"><title>proc~lsq&#45;&gt;proc~dscal</title>
<path fill="none" stroke="#000000" d="M144.202,-295.36C157.452,-290.484 173.735,-284.494 188.129,-279.198"/>
<polygon fill="#000000" stroke="#000000" points="189.555,-282.402 197.732,-275.665 187.138,-275.833 189.555,-282.402"/>
</g>
<!-- proc~lsq&#45;&gt;proc~enforce_bounds -->
<g id="proc~~slsqpb~~CallsGraph_edge24" class="edge"><title>proc~lsq&#45;&gt;proc~enforce_bounds</title>
<path fill="none" stroke="#000000" d="M128.45,-292.753C140.054,-279.698 159.825,-259.015 180,-245 182.068,-243.563 184.25,-242.177 186.491,-240.849"/>
<polygon fill="#000000" stroke="#000000" points="188.215,-243.895 195.312,-236.029 184.858,-237.752 188.215,-243.895"/>
</g>
<!-- proc~lsq&#45;&gt;proc~ddot -->
<g id="proc~~slsqpb~~CallsGraph_edge27" class="edge"><title>proc~lsq&#45;&gt;proc~ddot</title>
<path fill="none" stroke="#000000" d="M144.158,-307.93C176.107,-310.221 230.737,-309.874 270,-287 293.35,-273.397 285.797,-255.948 306,-238 340.372,-207.465 352.513,-201.921 396,-187 421.711,-178.178 452.164,-173.934 475.416,-171.892"/>
<polygon fill="#000000" stroke="#000000" points="475.852,-175.369 485.549,-171.101 475.307,-168.39 475.852,-175.369"/>
</g>
<!-- proc~lsei -->
<g id="proc~~slsqpb~~CallsGraph_node11" class="node"><title>proc~lsei</title>
<g id="a_proc~~slsqpb~~CallsGraph_node11"><a xlink:href="../proc/lsei.html" xlink:title="lsei">
<polygon fill="#d9534f" stroke="#d9534f" points="252,-358 198,-358 198,-334 252,-334 252,-358"/>
<text text-anchor="middle" x="225" y="-343.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lsei</text>
</a>
</g>
</g>
<!-- proc~lsq&#45;&gt;proc~lsei -->
<g id="proc~~slsqpb~~CallsGraph_edge26" class="edge"><title>proc~lsq&#45;&gt;proc~lsei</title>
<path fill="none" stroke="#000000" d="M144.202,-315.135C157.452,-320.26 173.735,-326.558 188.129,-332.125"/>
<polygon fill="#000000" stroke="#000000" points="187.143,-335.496 197.732,-335.84 189.668,-328.968 187.143,-335.496"/>
</g>
<!-- proc~lsei&#45;&gt;proc~dcopy -->
<g id="proc~~slsqpb~~CallsGraph_edge17" class="edge"><title>proc~lsei&#45;&gt;proc~dcopy</title>
<path fill="none" stroke="#000000" d="M236.497,-358.086C251.217,-374.712 279.201,-405.173 306,-428 365.739,-478.886 442.935,-529.672 483.77,-555.501"/>
<polygon fill="#000000" stroke="#000000" points="482.06,-558.56 492.388,-560.922 485.787,-552.635 482.06,-558.56"/>
</g>
<!-- proc~lsei&#45;&gt;proc~dnrm2 -->
<g id="proc~~slsqpb~~CallsGraph_edge20" class="edge"><title>proc~lsei&#45;&gt;proc~dnrm2</title>
<path fill="none" stroke="#000000" d="M252.242,-356.861C285.417,-370.399 344.431,-393.843 396,-411 422.479,-419.809 452.827,-428.391 475.84,-434.593"/>
<polygon fill="#000000" stroke="#000000" points="474.974,-437.985 485.538,-437.184 476.78,-431.222 474.974,-437.985"/>
</g>
<!-- proc~lsei&#45;&gt;proc~ddot -->
<g id="proc~~slsqpb~~CallsGraph_edge19" class="edge"><title>proc~lsei&#45;&gt;proc~ddot</title>
<path fill="none" stroke="#000000" d="M247.894,-333.941C255.082,-329.751 263.016,-324.876 270,-320 329.306,-278.594 333.782,-253.885 396,-217 421.35,-201.972 452.398,-189.675 475.992,-181.434"/>
<polygon fill="#000000" stroke="#000000" points="477.273,-184.695 485.608,-178.155 475.014,-178.07 477.273,-184.695"/>
</g>
<!-- proc~hfti -->
<g id="proc~~slsqpb~~CallsGraph_node12" class="node"><title>proc~hfti</title>
<g id="a_proc~~slsqpb~~CallsGraph_node12"><a xlink:href="../proc/hfti.html" xlink:title="hfti">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-498 486,-498 486,-474 540,-474 540,-498"/>
<text text-anchor="middle" x="513" y="-483.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hfti</text>
</a>
</g>
</g>
<!-- proc~lsei&#45;&gt;proc~hfti -->
<g id="proc~~slsqpb~~CallsGraph_edge18" class="edge"><title>proc~lsei&#45;&gt;proc~hfti</title>
<path fill="none" stroke="#000000" d="M240.972,-358.016C256.57,-370.157 282.033,-388.939 306,-402 363.143,-433.14 434.303,-459.677 476.276,-474.181"/>
<polygon fill="#000000" stroke="#000000" points="475.191,-477.508 485.785,-477.433 477.456,-470.885 475.191,-477.508"/>
</g>
<!-- proc~lsi -->
<g id="proc~~slsqpb~~CallsGraph_node13" class="node"><title>proc~lsi</title>
<g id="a_proc~~slsqpb~~CallsGraph_node13"><a xlink:href="../proc/lsi.html" xlink:title="lsi">
<polygon fill="#d9534f" stroke="#d9534f" points="360,-354 306,-354 306,-330 360,-330 360,-354"/>
<text text-anchor="middle" x="333" y="-339.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lsi</text>
</a>
</g>
</g>
<!-- proc~lsei&#45;&gt;proc~lsi -->
<g id="proc~~slsqpb~~CallsGraph_edge21" class="edge"><title>proc~lsei&#45;&gt;proc~lsi</title>
<path fill="none" stroke="#000000" d="M252.202,-345.011C265.325,-344.516 281.422,-343.909 295.713,-343.369"/>
<polygon fill="#000000" stroke="#000000" points="295.871,-346.866 305.732,-342.991 295.607,-339.871 295.871,-346.866"/>
</g>
<!-- proc~h12 -->
<g id="proc~~slsqpb~~CallsGraph_node14" class="node"><title>proc~h12</title>
<g id="a_proc~~slsqpb~~CallsGraph_node14"><a xlink:href="../proc/h12.html" xlink:title="h12">
<polygon fill="#d9534f" stroke="#d9534f" points="630,-313 576,-313 576,-289 630,-289 630,-313"/>
<text text-anchor="middle" x="603" y="-298.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h12</text>
</a>
</g>
</g>
<!-- proc~lsei&#45;&gt;proc~h12 -->
<g id="proc~~slsqpb~~CallsGraph_edge22" class="edge"><title>proc~lsei&#45;&gt;proc~h12</title>
<path fill="none" stroke="#000000" d="M235.127,-333.815C244.043,-321.898 257.988,-303.227 270,-287 286.078,-265.28 285.797,-255.948 306,-238 372.719,-178.728 398.53,-166.709 486,-149 509.523,-144.238 520.081,-135.612 540,-149 583.541,-178.264 596.522,-244.033 600.379,-278.679"/>
<polygon fill="#000000" stroke="#000000" points="596.905,-279.124 601.338,-288.748 603.874,-278.461 596.905,-279.124"/>
</g>
<!-- proc~hfti&#45;&gt;proc~h12 -->
<g id="proc~~slsqpb~~CallsGraph_edge2" class="edge"><title>proc~hfti&#45;&gt;proc~h12</title>
<path fill="none" stroke="#000000" d="M531.93,-473.969C534.951,-471.303 537.811,-468.283 540,-465 571.598,-417.608 552.517,-393.894 576,-342 579.128,-335.086 583.272,-327.965 587.33,-321.636"/>
<polygon fill="#000000" stroke="#000000" points="590.426,-323.304 593.086,-313.049 584.611,-319.407 590.426,-323.304"/>
</g>
<!-- proc~diff -->
<g id="proc~~slsqpb~~CallsGraph_node15" class="node"><title>proc~diff</title>
<g id="a_proc~~slsqpb~~CallsGraph_node15"><a xlink:href="../proc/diff.html" xlink:title="diff">
<polygon fill="#d94e8f" stroke="#d94e8f" points="630,-417 576,-417 576,-393 630,-393 630,-417"/>
<text text-anchor="middle" x="603" y="-402.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">diff</text>
</a>
</g>
</g>
<!-- proc~hfti&#45;&gt;proc~diff -->
<g id="proc~~slsqpb~~CallsGraph_edge1" class="edge"><title>proc~hfti&#45;&gt;proc~diff</title>
<path fill="none" stroke="#000000" d="M529.587,-473.787C533.064,-470.959 536.697,-467.922 540,-465 554.726,-451.974 570.649,-436.534 582.671,-424.578"/>
<polygon fill="#000000" stroke="#000000" points="585.365,-426.834 589.956,-417.286 580.412,-421.887 585.365,-426.834"/>
</g>
<!-- proc~lsi&#45;&gt;proc~daxpy -->
<g id="proc~~slsqpb~~CallsGraph_edge12" class="edge"><title>proc~lsi&#45;&gt;proc~daxpy</title>
<path fill="none" stroke="#000000" d="M360.265,-339.049C390.851,-335.612 441.551,-329.916 475.843,-326.063"/>
<polygon fill="#000000" stroke="#000000" points="476.371,-329.525 485.918,-324.931 475.589,-322.569 476.371,-329.525"/>
</g>
<!-- proc~lsi&#45;&gt;proc~dnrm2 -->
<g id="proc~~slsqpb~~CallsGraph_edge14" class="edge"><title>proc~lsi&#45;&gt;proc~dnrm2</title>
<path fill="none" stroke="#000000" d="M351.34,-354.141C363.61,-362.565 380.562,-373.867 396,-383 423.023,-398.986 454.617,-415.461 478.003,-427.254"/>
<polygon fill="#000000" stroke="#000000" points="476.66,-430.496 487.168,-431.848 479.797,-424.238 476.66,-430.496"/>
</g>
<!-- proc~lsi&#45;&gt;proc~ddot -->
<g id="proc~~slsqpb~~CallsGraph_edge16" class="edge"><title>proc~lsi&#45;&gt;proc~ddot</title>
<path fill="none" stroke="#000000" d="M343.578,-329.798C355.34,-315.077 376.176,-289.835 396,-270 426.265,-239.719 464.348,-207.969 488.442,-188.578"/>
<polygon fill="#000000" stroke="#000000" points="490.722,-191.236 496.345,-182.257 486.349,-185.77 490.722,-191.236"/>
</g>
<!-- proc~lsi&#45;&gt;proc~h12 -->
<g id="proc~~slsqpb~~CallsGraph_edge15" class="edge"><title>proc~lsi&#45;&gt;proc~h12</title>
<path fill="none" stroke="#000000" d="M360.235,-334.763C371.273,-331.729 384.256,-328.176 396,-325 435.962,-314.193 444.953,-306.379 486,-301 512.494,-297.528 542.684,-297.655 565.623,-298.583"/>
<polygon fill="#000000" stroke="#000000" points="565.459,-302.079 575.613,-299.056 565.79,-295.087 565.459,-302.079"/>
</g>
<!-- proc~ldp -->
<g id="proc~~slsqpb~~CallsGraph_node16" class="node"><title>proc~ldp</title>
<g id="a_proc~~slsqpb~~CallsGraph_node16"><a xlink:href="../proc/ldp.html" xlink:title="ldp">
<polygon fill="#d9534f" stroke="#d9534f" points="450,-374 396,-374 396,-350 450,-350 450,-374"/>
<text text-anchor="middle" x="423" y="-359.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ldp</text>
</a>
</g>
</g>
<!-- proc~lsi&#45;&gt;proc~ldp -->
<g id="proc~~slsqpb~~CallsGraph_edge13" class="edge"><title>proc~lsi&#45;&gt;proc~ldp</title>
<path fill="none" stroke="#000000" d="M360.403,-348.001C368.481,-349.837 377.507,-351.888 386.105,-353.842"/>
<polygon fill="#000000" stroke="#000000" points="385.392,-357.269 395.919,-356.072 386.943,-350.443 385.392,-357.269"/>
</g>
<!-- proc~ldp&#45;&gt;proc~dcopy -->
<g id="proc~~slsqpb~~CallsGraph_edge6" class="edge"><title>proc~ldp&#45;&gt;proc~dcopy</title>
<path fill="none" stroke="#000000" d="M429.112,-374.256C443.545,-408.862 484.744,-507.649 503.049,-551.537"/>
<polygon fill="#000000" stroke="#000000" points="499.904,-553.091 506.984,-560.973 506.365,-550.396 499.904,-553.091"/>
</g>
<!-- proc~ldp&#45;&gt;proc~daxpy -->
<g id="proc~~slsqpb~~CallsGraph_edge8" class="edge"><title>proc~ldp&#45;&gt;proc~daxpy</title>
<path fill="none" stroke="#000000" d="M450.403,-349.999C458.657,-346.247 467.9,-342.046 476.665,-338.061"/>
<polygon fill="#000000" stroke="#000000" points="478.264,-341.179 485.919,-333.855 475.367,-334.807 478.264,-341.179"/>
</g>
<!-- proc~ldp&#45;&gt;proc~dnrm2 -->
<g id="proc~~slsqpb~~CallsGraph_edge10" class="edge"><title>proc~ldp&#45;&gt;proc~dnrm2</title>
<path fill="none" stroke="#000000" d="M436.985,-374.099C451.283,-387.423 474.471,-409.03 491.286,-424.699"/>
<polygon fill="#000000" stroke="#000000" points="489.26,-427.594 498.962,-431.851 494.032,-422.473 489.26,-427.594"/>
</g>
<!-- proc~ldp&#45;&gt;proc~ddot -->
<g id="proc~~slsqpb~~CallsGraph_edge11" class="edge"><title>proc~ldp&#45;&gt;proc~ddot</title>
<path fill="none" stroke="#000000" d="M429.505,-349.99C444.074,-318.203 483.785,-231.56 502.28,-191.206"/>
<polygon fill="#000000" stroke="#000000" points="505.512,-192.555 506.497,-182.006 499.149,-189.638 505.512,-192.555"/>
</g>
<!-- proc~ldp&#45;&gt;proc~diff -->
<g id="proc~~slsqpb~~CallsGraph_edge9" class="edge"><title>proc~ldp&#45;&gt;proc~diff</title>
<path fill="none" stroke="#000000" d="M450.202,-372.941C461.122,-377.18 474.027,-381.777 486,-385 512.353,-392.095 542.779,-397.23 565.857,-400.52"/>
<polygon fill="#000000" stroke="#000000" points="565.518,-404.006 575.902,-401.901 566.472,-397.071 565.518,-404.006"/>
</g>
<!-- proc~nnls -->
<g id="proc~~slsqpb~~CallsGraph_node17" class="node"><title>proc~nnls</title>
<g id="a_proc~~slsqpb~~CallsGraph_node17"><a xlink:href="../proc/nnls.html" xlink:title="nnls">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-376 486,-376 486,-352 540,-352 540,-376"/>
<text text-anchor="middle" x="513" y="-361.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nnls</text>
</a>
</g>
</g>
<!-- proc~ldp&#45;&gt;proc~nnls -->
<g id="proc~~slsqpb~~CallsGraph_edge7" class="edge"><title>proc~ldp&#45;&gt;proc~nnls</title>
<path fill="none" stroke="#000000" d="M450.403,-362.6C458.393,-362.782 467.311,-362.984 475.824,-363.178"/>
<polygon fill="#000000" stroke="#000000" points="475.842,-366.679 485.919,-363.407 476.001,-359.681 475.842,-366.679"/>
</g>
<!-- proc~nnls&#45;&gt;proc~h12 -->
<g id="proc~~slsqpb~~CallsGraph_edge3" class="edge"><title>proc~nnls&#45;&gt;proc~h12</title>
<path fill="none" stroke="#000000" d="M530.967,-351.853C543.994,-342.527 562.181,-329.507 576.891,-318.976"/>
<polygon fill="#000000" stroke="#000000" points="578.991,-321.777 585.085,-313.11 574.916,-316.085 578.991,-321.777"/>
</g>
<!-- proc~nnls&#45;&gt;proc~diff -->
<g id="proc~~slsqpb~~CallsGraph_edge5" class="edge"><title>proc~nnls&#45;&gt;proc~diff</title>
<path fill="none" stroke="#000000" d="M539.927,-376.08C548.356,-380.007 557.855,-384.433 566.842,-388.619"/>
<polygon fill="#000000" stroke="#000000" points="565.412,-391.814 575.954,-392.865 568.368,-385.469 565.412,-391.814"/>
</g>
<!-- proc~g1 -->
<g id="proc~~slsqpb~~CallsGraph_node18" class="node"><title>proc~g1</title>
<g id="a_proc~~slsqpb~~CallsGraph_node18"><a xlink:href="../proc/g1.html" xlink:title="g1">
<polygon fill="#d9534f" stroke="#d9534f" points="630,-375 576,-375 576,-351 630,-351 630,-375"/>
<text text-anchor="middle" x="603" y="-360.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">g1</text>
</a>
</g>
</g>
<!-- proc~nnls&#45;&gt;proc~g1 -->
<g id="proc~~slsqpb~~CallsGraph_edge4" class="edge"><title>proc~nnls&#45;&gt;proc~g1</title>
<path fill="none" stroke="#000000" d="M540.403,-363.7C548.393,-363.609 557.311,-363.508 565.824,-363.411"/>
<polygon fill="#000000" stroke="#000000" points="565.959,-366.91 575.919,-363.296 565.88,-359.91 565.959,-366.91"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    
                      </div>
                    </div>
                  </div>
                </div>
                
     
     
     <h3>Called By</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~slsqpb~~CalledByGraph Pages: 1 -->
<svg id="procslsqpbCalledByGraph" width="270pt" height="32pt"
 viewBox="0.00 0.00 270.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~slsqpb~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~slsqpb~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 266,-28 266,4 -4,4"/>
<!-- proc~slsqpb -->
<g id="proc~~slsqpb~~CalledByGraph_node1" class="node"><title>proc~slsqpb</title>
<polygon fill="none" stroke="black" points="262,-24 208,-24 208,-0 262,-0 262,-24"/>
<text text-anchor="middle" x="235" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">slsqpb</text>
</g>
<!-- proc~slsqp -->
<g id="proc~~slsqpb~~CalledByGraph_node2" class="node"><title>proc~slsqp</title>
<g id="a_proc~~slsqpb~~CalledByGraph_node2"><a xlink:href="../proc/slsqp.html" xlink:title="slsqp">
<polygon fill="#d9534f" stroke="#d9534f" points="172,-24 118,-24 118,-0 172,-0 172,-24"/>
<text text-anchor="middle" x="145" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">slsqp</text>
</a>
</g>
</g>
<!-- proc~slsqp&#45;&gt;proc~slsqpb -->
<g id="proc~~slsqpb~~CalledByGraph_edge2" class="edge"><title>proc~slsqp&#45;&gt;proc~slsqpb</title>
<path fill="none" stroke="#000000" d="M172.403,-12C180.393,-12 189.311,-12 197.824,-12"/>
<polygon fill="#000000" stroke="#000000" points="197.919,-15.5001 207.919,-12 197.919,-8.5001 197.919,-15.5001"/>
</g>
<!-- proc~slsqp_wrapper -->
<g id="proc~~slsqpb~~CalledByGraph_node3" class="node"><title>proc~slsqp_wrapper</title>
<g id="a_proc~~slsqpb~~CalledByGraph_node3"><a xlink:href="../proc/slsqp_wrapper.html" xlink:title="slsqp_wrapper">
<polygon fill="#d9534f" stroke="#d9534f" points="82,-24 0,-24 0,-0 82,-0 82,-24"/>
<text text-anchor="middle" x="41" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">slsqp_wrapper</text>
</a>
</g>
</g>
<!-- proc~slsqp_wrapper&#45;&gt;proc~slsqp -->
<g id="proc~~slsqpb~~CalledByGraph_edge1" class="edge"><title>proc~slsqp_wrapper&#45;&gt;proc~slsqp</title>
<path fill="none" stroke="#000000" d="M82.0203,-12C90.4968,-12 99.3981,-12 107.726,-12"/>
<polygon fill="#000000" stroke="#000000" points="107.894,-15.5001 117.894,-12 107.894,-8.5001 107.894,-15.5001"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    
                      </div>
                    </div>
                  </div>
                </div>
                
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      




















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/slsqpb.html#src">slsqpb</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>    <span class="k">subroutine </span><span class="n">slsqpb</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">meq</span><span class="p">,</span><span class="n">la</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">xl</span><span class="p">,</span><span class="n">xu</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">acc</span><span class="p">,</span><span class="n">iter</span><span class="p">,</span><span class="n">mode</span><span class="p">,&amp;</span>
                      <span class="n">r</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">iw</span><span class="p">,&amp;</span>
                      <span class="n">t</span><span class="p">,</span><span class="n">f0</span><span class="p">,</span><span class="n">h1</span><span class="p">,</span><span class="n">h2</span><span class="p">,</span><span class="n">h3</span><span class="p">,</span><span class="n">h4</span><span class="p">,</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">n3</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">gs</span><span class="p">,</span><span class="n">tol</span><span class="p">,</span><span class="n">line</span><span class="p">,&amp;</span>
                      <span class="n">alpha</span><span class="p">,</span><span class="n">iexact</span><span class="p">,</span><span class="n">incons</span><span class="p">,</span><span class="n">ireset</span><span class="p">,</span><span class="n">itermx</span><span class="p">,</span><span class="n">ldat</span><span class="p">,&amp;</span>
                      <span class="n">alphamin</span><span class="p">,</span><span class="n">alphamax</span><span class="p">)</span>
    <span class="k">implicit none</span>

<span class="k">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">m</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">meq</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">la</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">n</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">x</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">xl</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">xu</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span>                            <span class="kd">::</span> <span class="n">f</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">la</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">c</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">g</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">la</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">a</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span>                            <span class="kd">::</span> <span class="n">acc</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">iter</span>     <span class="c">!! **in:**  maximum number of iterations.</span>
                                                    <span class="c">!! **out:** actual number of iterations.</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">mode</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">r</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">((</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">l</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">x0</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">la</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">mu</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">s</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">u</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">v</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">w</span>   <span class="c">!! `dim(w)` =</span>
                                               <span class="c">!!</span>
                                               <span class="c">!! * `n1*(n1+1) + meq*(n1+1) + mineq*(n1+1)`   for [[lsq]]</span>
                                               <span class="c">!! * `+(n1-meq+1)*(mineq+2) + 2*mineq`         for [[lsi]]</span>
                                               <span class="c">!! * `+(n1+mineq)*(n1-meq) + 2*meq + n1`       for [[lsei]]</span>
                                               <span class="c">!!</span>
                                               <span class="c">!! with `mineq = m - meq + 2*n1` &amp; `n1 = n+1`</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iw</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">t</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">f0</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">h1</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">h2</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">h3</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">h4</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">n1</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">n2</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">n3</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">t0</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">gs</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">tol</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">line</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">alpha</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">iexact</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">incons</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">ireset</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">itermx</span>
    <span class="k">type</span><span class="p">(</span><span class="n">linmin_data</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">ldat</span>      <span class="c">!! data for [[linmin]].</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">alphamin</span>  <span class="c">!! min \( \alpha \) for line search \( 0 &lt; \alpha_{min} &lt; \alpha_{max} \le 1 \)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">alphamax</span>  <span class="c">!! max \( \alpha \) for line search \( 0 &lt; \alpha_{min} &lt; \alpha_{max} \le 1 \)</span>

    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">mode</span><span class="o">&lt;</span><span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>

        <span class="c">! call jacobian at current x</span>

        <span class="c">! update cholesky-factors of hessian matrix by modified bfgs formula</span>

        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">n</span>
            <span class="n">u</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">ddot</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">end do</span>

        <span class="c">! l&#39;*s</span>

        <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">n</span>
            <span class="n">h1</span> <span class="o">=</span> <span class="n">zero</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">n</span>
                <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">h1</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">+</span> <span class="n">l</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">s</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="k">end do</span>
<span class="k">            </span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">h1</span>
        <span class="k">end do</span>

        <span class="c">! d*l&#39;*s</span>

        <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">n</span>
            <span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">l</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="n">n1</span> <span class="o">-</span> <span class="n">i</span>
        <span class="k">end do</span>

        <span class="c">! l*d*l&#39;*s</span>

        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">n</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">h1</span> <span class="o">=</span> <span class="n">zero</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">h1</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">+</span> <span class="n">l</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="n">n</span> <span class="o">-</span> <span class="n">j</span>
            <span class="k">end do</span>
<span class="k">            </span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">h1</span>
        <span class="k">end do</span>

<span class="k">        </span><span class="n">h1</span> <span class="o">=</span> <span class="n">ddot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">h2</span> <span class="o">=</span> <span class="n">ddot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">h3</span> <span class="o">=</span> <span class="mf">0.2_wp</span><span class="o">*</span><span class="n">h2</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">h1</span><span class="o">&lt;</span><span class="n">h3</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">h4</span> <span class="o">=</span> <span class="p">(</span><span class="n">h2</span><span class="o">-</span><span class="n">h3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">h2</span><span class="o">-</span><span class="n">h1</span><span class="p">)</span>
            <span class="n">h1</span> <span class="o">=</span> <span class="n">h3</span>
            <span class="k">call </span><span class="n">dscal</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">h4</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">call </span><span class="n">daxpy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">one</span><span class="o">-</span><span class="n">h4</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">end if</span>
<span class="k">        call </span><span class="n">ldl</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="o">+</span><span class="n">one</span><span class="o">/</span><span class="n">h1</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
        <span class="k">call </span><span class="n">ldl</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="o">-</span><span class="n">one</span><span class="o">/</span><span class="n">h2</span><span class="p">,</span><span class="n">u</span><span class="p">)</span>

        <span class="c">! end of main iteration</span>

        <span class="k">goto </span><span class="mi">200</span>

    <span class="k">else if</span> <span class="p">(</span> <span class="n">mode</span><span class="o">==</span><span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">        </span><span class="n">itermx</span> <span class="o">=</span> <span class="n">iter</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">acc</span><span class="o">&gt;=</span><span class="n">zero</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">iexact</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span>
<span class="k">            </span><span class="n">iexact</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">acc</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">acc</span><span class="p">)</span>
        <span class="n">tol</span> <span class="o">=</span> <span class="n">ten</span><span class="o">*</span><span class="n">acc</span>
        <span class="n">iter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ireset</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">n1</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="n">n1</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">n3</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">zero</span>
        <span class="n">mu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">zero</span>
        <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">mu</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">else</span>

        <span class="c">! call functions at current x</span>

        <span class="n">t</span> <span class="o">=</span> <span class="n">f</span>
        <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">m</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">j</span><span class="o">&lt;=</span><span class="n">meq</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                </span><span class="n">h1</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="k">else</span>
<span class="k">                </span><span class="n">h1</span> <span class="o">=</span> <span class="n">zero</span>
            <span class="k">end if</span>
<span class="k">            </span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">mu</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">h1</span><span class="p">)</span>
        <span class="k">end do</span>
<span class="k">        </span><span class="n">h1</span> <span class="o">=</span> <span class="n">t</span> <span class="o">-</span> <span class="n">t0</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">iexact</span><span class="o">+</span><span class="mi">1</span><span class="o">==</span><span class="mi">1</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            if</span> <span class="p">(</span> <span class="n">h1</span><span class="o">&lt;=</span><span class="n">h3</span><span class="o">/</span><span class="n">ten</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">line</span><span class="o">&gt;</span><span class="mi">10</span> <span class="p">)</span> <span class="k">goto </span><span class="mi">500</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">h3</span><span class="o">/</span><span class="p">(</span><span class="n">two</span><span class="o">*</span><span class="p">(</span><span class="n">h3</span><span class="o">-</span><span class="n">h1</span><span class="p">)),</span><span class="n">alphamin</span><span class="p">),</span><span class="n">alphamax</span><span class="p">)</span>
            <span class="k">goto </span><span class="mi">300</span>
        <span class="k">else if</span> <span class="p">(</span> <span class="n">iexact</span><span class="o">+</span><span class="mi">1</span><span class="o">==</span><span class="mi">2</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            goto </span><span class="mi">400</span>
        <span class="k">else</span>
<span class="k">            goto </span><span class="mi">500</span>
        <span class="k">end if</span>

<span class="k">    end if</span>

    <span class="c">! reset bfgs matrix</span>

<span class="mi">100</span> <span class="n">ireset</span> <span class="o">=</span> <span class="n">ireset</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">ireset</span><span class="o">&gt;</span><span class="mi">5</span> <span class="p">)</span> <span class="k">then</span>
        <span class="c">! check relaxed convergence in case of positive directional derivative</span>
        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="o">-</span><span class="n">f0</span><span class="p">)</span><span class="o">&lt;</span><span class="n">tol</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">dnrm2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;</span><span class="n">tol</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">h3</span><span class="o">&lt;</span><span class="n">tol</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span>
<span class="k">            </span><span class="n">mode</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="k">end if</span>
<span class="k">        return</span>
<span class="k">    else</span>
<span class="k">        </span><span class="n">l</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">zero</span>
        <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span><span class="n">l</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">n</span>
            <span class="n">l</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">one</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="n">n1</span> <span class="o">-</span> <span class="n">i</span>
        <span class="k">end do</span>
<span class="k">    end if</span>

    <span class="c">! main iteration : search direction, steplength, ldl&#39;-update</span>

<span class="mi">200</span> <span class="n">iter</span> <span class="o">=</span> <span class="n">iter</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">iter</span><span class="o">&gt;</span><span class="n">itermx</span> <span class="p">)</span> <span class="k">return</span>

    <span class="c">! search direction as solution of qp - subproblem</span>

    <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">xl</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">xu</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">daxpy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="o">-</span><span class="n">one</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">daxpy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="o">-</span><span class="n">one</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">h4</span> <span class="o">=</span> <span class="n">one</span>
    <span class="k">call </span><span class="n">lsq</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">meq</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">n3</span><span class="p">,</span><span class="n">la</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">iw</span><span class="p">,</span><span class="n">mode</span><span class="p">)</span>

    <span class="c">! augmented problem for inconsistent linearization</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">mode</span><span class="o">==</span><span class="mi">6</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span> <span class="n">n</span><span class="o">==</span><span class="n">meq</span> <span class="p">)</span> <span class="n">mode</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">end if</span>
<span class="k">    if</span> <span class="p">(</span> <span class="n">mode</span><span class="o">==</span><span class="mi">4</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">m</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">j</span><span class="o">&lt;=</span><span class="n">meq</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                </span><span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="k">else</span>
<span class="k">                </span><span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">zero</span><span class="p">)</span>
            <span class="k">end if</span>
<span class="k">        end do</span>
<span class="k">        </span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">zero</span>
        <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">h3</span> <span class="o">=</span> <span class="n">zero</span>
        <span class="n">g</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="n">zero</span>
        <span class="n">l</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span> <span class="o">=</span> <span class="n">hun</span>
        <span class="n">s</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="n">one</span>
        <span class="n">u</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="n">zero</span>
        <span class="n">v</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="n">one</span>
        <span class="n">incons</span> <span class="o">=</span> <span class="mi">0</span>
<span class="mi">250</span>     <span class="k">call </span><span class="n">lsq</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">meq</span><span class="p">,</span><span class="n">n1</span><span class="p">,</span><span class="n">n3</span><span class="p">,</span><span class="n">la</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">iw</span><span class="p">,</span><span class="n">mode</span><span class="p">)</span>
        <span class="n">h4</span> <span class="o">=</span> <span class="n">one</span> <span class="o">-</span> <span class="n">s</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">mode</span><span class="o">==</span><span class="mi">4</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">l</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ten</span><span class="o">*</span><span class="n">l</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span>
            <span class="n">incons</span> <span class="o">=</span> <span class="n">incons</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">incons</span><span class="o">&lt;=</span><span class="mi">5</span> <span class="p">)</span> <span class="k">goto </span><span class="mi">250</span>
            <span class="k">return</span>
<span class="k">        else if</span> <span class="p">(</span> <span class="n">mode</span><span class="o">/=</span><span class="mi">1</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            return</span>
<span class="k">        end if</span>
<span class="k">    else if</span> <span class="p">(</span> <span class="n">mode</span><span class="o">/=</span><span class="mi">1</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        return</span>
<span class="k">    end if</span>

    <span class="c">! update multipliers for l1-test</span>

    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">n</span>
        <span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">ddot</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">end do</span>
<span class="k">    </span><span class="n">f0</span> <span class="o">=</span> <span class="n">f</span>
    <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">ddot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">gs</span><span class="p">)</span>
    <span class="n">h2</span> <span class="o">=</span> <span class="n">zero</span>
    <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">m</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">j</span><span class="o">&lt;=</span><span class="n">meq</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">h3</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="k">else</span>
<span class="k">            </span><span class="n">h3</span> <span class="o">=</span> <span class="n">zero</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">h2</span> <span class="o">=</span> <span class="n">h2</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">h3</span><span class="p">)</span>
        <span class="n">h3</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">r</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
        <span class="n">mu</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">h3</span><span class="p">,(</span><span class="n">mu</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">h3</span><span class="p">)</span><span class="o">/</span><span class="n">two</span><span class="p">)</span>
        <span class="n">h1</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">+</span> <span class="n">h3</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
    <span class="k">end do</span>

    <span class="c">! check convergence</span>

    <span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">h1</span><span class="o">&lt;</span><span class="n">acc</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">h2</span><span class="o">&lt;</span><span class="n">acc</span> <span class="p">)</span> <span class="k">return</span>
<span class="k">    </span><span class="n">h1</span> <span class="o">=</span> <span class="n">zero</span>
    <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">m</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">j</span><span class="o">&lt;=</span><span class="n">meq</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">h3</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="k">else</span>
<span class="k">            </span><span class="n">h3</span> <span class="o">=</span> <span class="n">zero</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">h1</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">+</span> <span class="n">mu</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">h3</span><span class="p">)</span>
    <span class="k">end do</span>
<span class="k">    </span><span class="n">t0</span> <span class="o">=</span> <span class="n">f</span> <span class="o">+</span> <span class="n">h1</span>
    <span class="n">h3</span> <span class="o">=</span> <span class="n">gs</span> <span class="o">-</span> <span class="n">h1</span><span class="o">*</span><span class="n">h4</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">h3</span><span class="o">&gt;=</span><span class="n">zero</span> <span class="p">)</span> <span class="k">goto </span><span class="mi">100</span>

    <span class="c">! line search with an l1-testfunction</span>

    <span class="n">line</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">alphamax</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">iexact</span><span class="o">==</span><span class="mi">1</span> <span class="p">)</span> <span class="k">goto </span><span class="mi">400</span>

    <span class="c">! inexact linesearch</span>

<span class="mi">300</span> <span class="n">line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">h3</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">h3</span>
    <span class="k">call </span><span class="n">dscal</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">daxpy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">one</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">call </span><span class="n">enforce_bounds</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">xl</span><span class="p">,</span><span class="n">xu</span><span class="p">)</span>  <span class="c">! ensure that x doesn&#39;t violate bounds</span>

    <span class="n">mode</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span>

    <span class="c">! exact linesearch</span>

<span class="mi">400</span> <span class="k">if</span> <span class="p">(</span> <span class="n">line</span><span class="o">/=</span><span class="mi">3</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">linmin</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="n">alphamin</span><span class="p">,</span><span class="n">alphamax</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">tol</span><span class="p">,</span> <span class="p">&amp;</span>
        <span class="n">ldat</span><span class="p">%</span><span class="n">a</span><span class="p">,</span> <span class="n">ldat</span><span class="p">%</span><span class="n">b</span><span class="p">,</span> <span class="n">ldat</span><span class="p">%</span><span class="n">d</span><span class="p">,</span> <span class="n">ldat</span><span class="p">%</span><span class="n">e</span><span class="p">,</span> <span class="n">ldat</span><span class="p">%</span><span class="n">p</span><span class="p">,</span>   <span class="n">ldat</span><span class="p">%</span><span class="n">q</span><span class="p">,</span>   <span class="p">&amp;</span>
        <span class="n">ldat</span><span class="p">%</span><span class="n">r</span><span class="p">,</span> <span class="n">ldat</span><span class="p">%</span><span class="n">u</span><span class="p">,</span> <span class="n">ldat</span><span class="p">%</span><span class="n">v</span><span class="p">,</span> <span class="n">ldat</span><span class="p">%</span><span class="n">w</span><span class="p">,</span> <span class="n">ldat</span><span class="p">%</span><span class="n">x</span><span class="p">,</span>   <span class="n">ldat</span><span class="p">%</span><span class="n">m</span><span class="p">,</span>   <span class="p">&amp;</span>
        <span class="n">ldat</span><span class="p">%</span><span class="n">fu</span><span class="p">,</span><span class="n">ldat</span><span class="p">%</span><span class="n">fv</span><span class="p">,</span><span class="n">ldat</span><span class="p">%</span><span class="n">fw</span><span class="p">,</span><span class="n">ldat</span><span class="p">%</span><span class="n">fx</span><span class="p">,</span><span class="n">ldat</span><span class="p">%</span><span class="n">tol1</span><span class="p">,</span><span class="n">ldat</span><span class="p">%</span><span class="n">tol2</span> <span class="p">)</span>
        <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">call </span><span class="n">daxpy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span>
<span class="k">    end if</span>
<span class="k">    call </span><span class="n">dscal</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    <span class="c">! check convergence</span>

<span class="mi">500</span> <span class="n">h3</span> <span class="o">=</span> <span class="n">zero</span>
    <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">m</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">j</span><span class="o">&lt;=</span><span class="n">meq</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">h1</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="k">else</span>
<span class="k">            </span><span class="n">h1</span> <span class="o">=</span> <span class="n">zero</span>
        <span class="k">end if</span>
<span class="k">        </span><span class="n">h3</span> <span class="o">=</span> <span class="n">h3</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">h1</span><span class="p">)</span>
    <span class="k">end do</span>

<span class="k">    if</span> <span class="p">(</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="o">-</span><span class="n">f0</span><span class="p">)</span><span class="o">&lt;</span><span class="n">acc</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">dnrm2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;</span><span class="n">acc</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">h3</span><span class="o">&lt;</span><span class="n">acc</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span>
<span class="k">        </span><span class="n">mode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">end if</span>

<span class="k">    end subroutine </span><span class="n">slsqpb</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>
    

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprocs-1">All Procedures</a></h3></div>
  <div id="allprocs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/daxpy.html">daxpy</a>
      
      <a class="list-group-item" href="../proc/dcopy.html">dcopy</a>
      
      <a class="list-group-item" href="../proc/ddot.html">ddot</a>
      
      <a class="list-group-item" href="../proc/destroy_linmin_data.html">destroy_linmin_data</a>
      
      <a class="list-group-item" href="../proc/destroy_slsqp.html">destroy_slsqp</a>
      
      <a class="list-group-item" href="../proc/destroy_slsqpb_data.html">destroy_slsqpb_data</a>
      
      <a class="list-group-item" href="../proc/diff.html">diff</a>
      
      <a class="list-group-item" href="../proc/dnrm2.html">dnrm2</a>
      
      <a class="list-group-item" href="../proc/dscal.html">dscal</a>
      
      <a class="list-group-item" href="../proc/dummy_grad.html">dummy_grad</a>
      
      <a class="list-group-item" href="../proc/enforce_bounds.html">enforce_bounds</a>
      
      <a class="list-group-item" href="../proc/g1.html">g1</a>
      
      <a class="list-group-item" href="../proc/h12.html">h12</a>
      
      <a class="list-group-item" href="../proc/hfti.html">hfti</a>
      
      <a class="list-group-item" href="../proc/initialize_slsqp.html">initialize_slsqp</a>
      
      <a class="list-group-item" href="../proc/ldl.html">ldl</a>
      
      <a class="list-group-item" href="../proc/ldp.html">ldp</a>
      
      <a class="list-group-item" href="../proc/linmin.html">linmin</a>
      
      <a class="list-group-item" href="../proc/lsei.html">lsei</a>
      
      <a class="list-group-item" href="../proc/lsi.html">lsi</a>
      
      <a class="list-group-item" href="../proc/lsq.html">lsq</a>
      
      <a class="list-group-item" href="../proc/mode_to_status_message.html">mode_to_status_message</a>
      
      <a class="list-group-item" href="../proc/nnls.html">nnls</a>
      
      <a class="list-group-item" href="../proc/report_iteration.html">report_iteration</a>
      
      <a class="list-group-item" href="../proc/report_iteration%7E2.html">report_iteration</a>
      
      <a class="list-group-item" href="../proc/report_iteration%7E3.html">report_iteration</a>
      
      <a class="list-group-item" href="../proc/report_message.html">report_message</a>
      
      <a class="list-group-item" href="../proc/rosenbrock_func.html">rosenbrock_func</a>
      
      <a class="list-group-item" href="../proc/rosenbrock_func%7E2.html">rosenbrock_func</a>
      
      <a class="list-group-item" href="../proc/rosenbrock_grad.html">rosenbrock_grad</a>
      
      <a class="list-group-item" href="../proc/slsqp.html">slsqp</a>
      
      <a class="list-group-item" href="../proc/slsqp_wrapper.html">slsqp_wrapper</a>
      
      <a class="list-group-item" href="../proc/slsqpb.html">slsqpb</a>
      
      <a class="list-group-item" href="../proc/stop_iterations.html">stop_iterations</a>
      
      <a class="list-group-item" href="../proc/test_func.html">test_func</a>
      
      <a class="list-group-item" href="../proc/test_grad.html">test_grad</a>
      
    </div>
  </div>
</div>


  </section>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> slsqp was developed by Jacob Williams</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>