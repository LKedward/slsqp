<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="Modern Fortran Implementation of the SLSQP Optimization Method">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>slsqpb &ndash; slsqp</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">slsqp </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
                
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
				
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
				
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../program/slsqp_test.html">Program</a></li>
				
          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>slsqpb
    <small>Subroutine</small>
    
    </h1>
	 
<div class="row">
<div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
    <li><i class="fa fa-code"></i><a href="../src/slsqp_core.f90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/slsqp_core.f90.html'>slsqp_core.f90</a></li>
  
     <li><a href='../module/slsqp_core.html'>slsqp_core</a></li>
  
     <li class="active">slsqpb</li>
  </ol>
</div>
</div>
</div>
    
  </div>
  
  <div class="row">
    <div class="col-lg-3">
    
<div id="sidebar">
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars">Variables</a></h3></div>
    <div id="vars" class="panel-collapse collapse">
      <div class="list-group">
        
        <a class="list-group-item" href="../proc/slsqpb.html#variable-i%7E6">i</a>
        
        <a class="list-group-item" href="../proc/slsqpb.html#variable-k">k</a>
        
        <a class="list-group-item" href="../proc/slsqpb.html#variable-j">j</a>
        
        <a class="list-group-item" href="../proc/slsqpb.html#variable-alfmin">alfmin</a>
        
      </div>
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
    <div class="list-group">
      <a class="list-group-item" href="../proc/slsqpb.html#src">slsqpb</a>
    </div>
  </div>
  
  <hr>
  
  <div class="panel panel-default">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprocs">All Procedures</a></h3></div>
    <div id="allprocs" class="panel-collapse collapse">
        <div class="list-group">
          
          <a class="list-group-item" href="../proc/daxpy.html">daxpy</a>
          
          <a class="list-group-item" href="../proc/dcopy.html">dcopy</a>
          
          <a class="list-group-item" href="../proc/ddot.html">ddot</a>
          
          <a class="list-group-item" href="../proc/destroy_slsqp.html">destroy_slsqp</a>
          
          <a class="list-group-item" href="../proc/diff.html">diff</a>
          
          <a class="list-group-item" href="../proc/dnrm2.html">dnrm2</a>
          
          <a class="list-group-item" href="../proc/dscal.html">dscal</a>
          
          <a class="list-group-item" href="../proc/enforce_bounds.html">enforce_bounds</a>
          
          <a class="list-group-item" href="../proc/g1.html">g1</a>
          
          <a class="list-group-item" href="../proc/h12.html">h12</a>
          
          <a class="list-group-item" href="../proc/hfti.html">hfti</a>
          
          <a class="list-group-item" href="../proc/initialize_slsqp.html">initialize_slsqp</a>
          
          <a class="list-group-item" href="../proc/ldl.html">ldl</a>
          
          <a class="list-group-item" href="../proc/ldp.html">ldp</a>
          
          <a class="list-group-item" href="../proc/linmin.html">linmin</a>
          
          <a class="list-group-item" href="../proc/lsei.html">lsei</a>
          
          <a class="list-group-item" href="../proc/lsi.html">lsi</a>
          
          <a class="list-group-item" href="../proc/lsq.html">lsq</a>
          
          <a class="list-group-item" href="../proc/nnls.html">nnls</a>
          
          <a class="list-group-item" href="../proc/report_iteration.html">report_iteration</a>
          
          <a class="list-group-item" href="../proc/report_message.html">report_message</a>
          
          <a class="list-group-item" href="../proc/rosenbrock_func.html">rosenbrock_func</a>
          
          <a class="list-group-item" href="../proc/rosenbrock_grad.html">rosenbrock_grad</a>
          
          <a class="list-group-item" href="../proc/slsqp.html">slsqp</a>
          
          <a class="list-group-item" href="../proc/slsqp_wrapper.html">slsqp_wrapper</a>
          
          <a class="list-group-item" href="../proc/slsqpb.html">slsqpb</a>
          
        </div>
    </div>
  </div>
  
</div>

    </div>
    
    <div class="col-lg-9" id='text'>
    <h2>
private subroutine slsqpb(m, meq, la, n, x, xl, xu, f, c, g, a, acc, iter, mode, r, l, x0, mu, s, u, v, w, iw, t, f0, h1, h2, h3, h4, n1, n2, n3, t0, gs, tol, line, alpha, iexact, incons, ireset, itermx, ldat)
    
    
    
</h2>
    
  



    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-m%7E10"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>m</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-meq%7E4"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>meq</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-la%7E3"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>la</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n%7E9"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-x%7E9"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>x</strong>(n)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xl%7E4"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>xl</strong>(n)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xu%7E4"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>xu</strong>(n)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f%7E8"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>f</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-c%7E6"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>c</strong>(la)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-g%7E6"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>g</strong>(n+1)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-a%7E6"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>a</strong>(la,n+1)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-acc%7E5"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>acc</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iter%7E4"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iter</strong></td><td><p><strong>in:</strong>  maximum number of iterations.
 <strong>out:</strong> actual number of iterations.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mode%7E4"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>mode</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-r%7E3"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>r</strong>(m+n+n+2)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-l"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>l</strong>((n+1)*(n+2)/2)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-x0"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>x0</strong>(n)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mu"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>mu</strong>(la)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-s"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>s</strong>(n+1)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-u%7E4"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>u</strong>(n+1)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-v%7E4"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>v</strong>(n+1)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-w%7E5"></span>real(kind=wp)</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>w</strong>(*)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iw%7E2"></span>integer</td>
  <td></td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iw</strong>(*)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>t</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f0%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>f0</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-h1%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>h1</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-h2%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>h2</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-h3%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>h3</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-h4%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>h4</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n1%7E4"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n1</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n2%7E2"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n2</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n3%7E2"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n3</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t0%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>t0</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-gs%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>gs</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tol%7E3"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>tol</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-line%7E2"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>line</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-alpha%7E2"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>alpha</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iexact%7E2"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iexact</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-incons%7E2"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>incons</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ireset%7E2"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ireset</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-itermx%7E2"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>itermx</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ldat%7E2"></span>type(<a href='../type/linmin_data.html'>linmin_data</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ldat</strong></td><td><p>data for <a href="../proc/linmin.html">linmin</a>.</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <h3>Description</h3>
    <p>nonlinear programming by solving sequentially quadratic programs</p>
<p>l1 - line search,  positive definite  bfgs update</p>
    
    
     <h3>Calls</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: proc~~slsqpb~~CallsGraph Pages: 1 -->
<svg id="procslsqpbCallsGraph" width="638pt" height="394pt"
 viewBox="0.00 0.00 638.00 394.16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~slsqpb~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 390.156)">
<title>proc~~slsqpb~~CallsGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-390.156 635,-390.156 635,5 -4,5"/>
<!-- proc~slsqpb -->
<g id="node1" class="node"><title>proc~slsqpb</title>
<polygon fill="none" stroke="black" points="54,-168 2.13163e-14,-168 0,-142 54,-142 54,-168"/>
<text text-anchor="middle" x="27" y="-152.55" font-family="Helvetica,sans-Serif" font-size="10.50">slsqpb</text>
</g>
<!-- proc~lsq -->
<g id="node2" class="node"><title>proc~lsq</title>
<a xlink:href="../proc/lsq.html" xlink:title="lsq">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-212 90,-212 90,-186 144,-186 144,-212"/>
<text text-anchor="middle" x="117" y="-196.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lsq</text>
</a>
</g>
<!-- proc~slsqpb&#45;&gt;proc~lsq -->
<g id="edge48" class="edge"><title>proc~slsqpb&#45;&gt;proc~lsq</title>
<path fill="none" stroke="black" d="M54.003,-168.201C62.5341,-172.372 72.0985,-177.048 81.1476,-181.472"/>
<polygon fill="black" stroke="black" points="79.8051,-184.712 90.3262,-185.959 82.8796,-178.423 79.8051,-184.712"/>
</g>
<!-- proc~linmin -->
<g id="node3" class="node"><title>proc~linmin</title>
<a xlink:href="../proc/linmin.html" xlink:title="linmin">
<polygon fill="#d94e8f" stroke="#d94e8f" points="144,-331 90,-331 90,-305 144,-305 144,-331"/>
<text text-anchor="middle" x="117" y="-315.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linmin</text>
</a>
</g>
<!-- proc~slsqpb&#45;&gt;proc~linmin -->
<g id="edge50" class="edge"><title>proc~slsqpb&#45;&gt;proc~linmin</title>
<path fill="none" stroke="black" d="M31.3442,-168.174C40.0402,-193.435 61.2462,-249.825 90,-291 91.4945,-293.14 93.1679,-295.261 94.93,-297.317"/>
<polygon fill="black" stroke="black" points="92.5826,-299.93 101.974,-304.835 97.6909,-295.145 92.5826,-299.93"/>
</g>
<!-- proc~daxpy -->
<g id="node4" class="node"><title>proc~daxpy</title>
<a xlink:href="../proc/daxpy.html" xlink:title="daxpy">
<polygon fill="#d9534f" stroke="#d9534f" points="450,-26 396,-26 396,-1.24345e-14 450,-3.55271e-15 450,-26"/>
<text text-anchor="middle" x="423" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">daxpy</text>
</a>
</g>
<!-- proc~slsqpb&#45;&gt;proc~daxpy -->
<g id="edge52" class="edge"><title>proc~slsqpb&#45;&gt;proc~daxpy</title>
<path fill="none" stroke="black" d="M31.8214,-141.742C40.2047,-120.669 59.5419,-79.795 90,-59 181.087,3.18844 319.158,-1.37099 385.209,-8.02061"/>
<polygon fill="black" stroke="black" points="385.232,-11.5434 395.55,-9.13945 385.985,-4.58401 385.232,-11.5434"/>
</g>
<!-- proc~dscal -->
<g id="node5" class="node"><title>proc~dscal</title>
<a xlink:href="../proc/dscal.html" xlink:title="dscal">
<polygon fill="#d9534f" stroke="#d9534f" points="252,-131 198,-131 198,-105 252,-105 252,-131"/>
<text text-anchor="middle" x="225" y="-115.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dscal</text>
</a>
</g>
<!-- proc~slsqpb&#45;&gt;proc~dscal -->
<g id="edge54" class="edge"><title>proc~slsqpb&#45;&gt;proc~dscal</title>
<path fill="none" stroke="black" d="M54.2069,-143.993C65.1651,-139.959 78.0246,-135.72 90,-133 122.482,-125.623 160.219,-121.82 187.523,-119.893"/>
<polygon fill="black" stroke="black" points="188.057,-123.366 197.808,-119.221 187.601,-116.381 188.057,-123.366"/>
</g>
<!-- proc~ldl -->
<g id="node6" class="node"><title>proc~ldl</title>
<a xlink:href="../proc/ldl.html" xlink:title="ldl">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-168 90,-168 90,-142 144,-142 144,-168"/>
<text text-anchor="middle" x="117" y="-152.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ldl</text>
</a>
</g>
<!-- proc~slsqpb&#45;&gt;proc~ldl -->
<g id="edge56" class="edge"><title>proc~slsqpb&#45;&gt;proc~ldl</title>
<path fill="none" stroke="black" d="M54.003,-155C62.0277,-155 70.9665,-155 79.5309,-155"/>
<polygon fill="black" stroke="black" points="79.7051,-158.5 89.705,-155 79.705,-151.5 79.7051,-158.5"/>
</g>
<!-- proc~dnrm2 -->
<g id="node7" class="node"><title>proc~dnrm2</title>
<a xlink:href="../proc/dnrm2.html" xlink:title="dnrm2">
<polygon fill="#d94e8f" stroke="#d94e8f" points="450,-292 396,-292 396,-266 450,-266 450,-292"/>
<text text-anchor="middle" x="423" y="-276.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dnrm2</text>
</a>
</g>
<!-- proc~slsqpb&#45;&gt;proc~dnrm2 -->
<g id="edge58" class="edge"><title>proc~slsqpb&#45;&gt;proc~dnrm2</title>
<path fill="none" stroke="black" d="M29.4575,-168.208C36.9691,-206.998 60.8937,-319.164 90,-340 122.725,-363.426 130.888,-431.261 360,-339 379.493,-331.151 396.405,-314.112 407.785,-300.191"/>
<polygon fill="black" stroke="black" points="410.752,-302.077 414.129,-292.035 405.226,-297.779 410.752,-302.077"/>
</g>
<!-- proc~ddot -->
<g id="node8" class="node"><title>proc~ddot</title>
<a xlink:href="../proc/ddot.html" xlink:title="ddot">
<polygon fill="#d94e8f" stroke="#d94e8f" points="450,-87 396,-87 396,-61 450,-61 450,-87"/>
<text text-anchor="middle" x="423" y="-71.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ddot</text>
</a>
</g>
<!-- proc~slsqpb&#45;&gt;proc~ddot -->
<g id="edge60" class="edge"><title>proc~slsqpb&#45;&gt;proc~ddot</title>
<path fill="none" stroke="black" d="M39.0593,-141.59C51.0787,-128.765 70.5084,-109.44 90,-96 126.655,-70.7249 136.621,-62.0361 180,-52 251.515,-35.4544 337.553,-51.3882 385.686,-63.4121"/>
<polygon fill="black" stroke="black" points="385.091,-66.8731 395.648,-65.9813 386.839,-60.0949 385.091,-66.8731"/>
</g>
<!-- proc~enforce_bounds -->
<g id="node9" class="node"><title>proc~enforce_bounds</title>
<a xlink:href="../proc/enforce_bounds.html" xlink:title="enforce_bounds">
<polygon fill="#d9534f" stroke="#d9534f" points="270,-87 180,-87 180,-61 270,-61 270,-87"/>
<text text-anchor="middle" x="225" y="-71.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">enforce_bounds</text>
</a>
</g>
<!-- proc~slsqpb&#45;&gt;proc~enforce_bounds -->
<g id="edge62" class="edge"><title>proc~slsqpb&#45;&gt;proc~enforce_bounds</title>
<path fill="none" stroke="black" d="M48.3775,-141.87C60.3495,-134.839 75.7049,-126.345 90,-120 115.873,-108.515 145.561,-98.1145 170.496,-90.1198"/>
<polygon fill="black" stroke="black" points="171.675,-93.4179 180.155,-87.0663 169.565,-86.7435 171.675,-93.4179"/>
</g>
<!-- proc~dcopy -->
<g id="node10" class="node"><title>proc~dcopy</title>
<a xlink:href="../proc/dcopy.html" xlink:title="dcopy">
<polygon fill="#d9534f" stroke="#d9534f" points="360,-330 306,-330 306,-304 360,-304 360,-330"/>
<text text-anchor="middle" x="333" y="-314.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dcopy</text>
</a>
</g>
<!-- proc~slsqpb&#45;&gt;proc~dcopy -->
<g id="edge64" class="edge"><title>proc~slsqpb&#45;&gt;proc~dcopy</title>
<path fill="none" stroke="black" d="M36.8342,-168.236C48.244,-182.819 68.2879,-206.167 90,-221 156.051,-266.125 246.414,-294.635 296.25,-308.008"/>
<polygon fill="black" stroke="black" points="295.391,-311.401 305.952,-310.557 297.17,-304.631 295.391,-311.401"/>
</g>
<!-- proc~lsq&#45;&gt;proc~dscal -->
<g id="edge46" class="edge"><title>proc~lsq&#45;&gt;proc~dscal</title>
<path fill="none" stroke="black" d="M133.37,-185.85C136.899,-182.962 140.593,-179.9 144,-177 160.302,-163.124 162.747,-157.673 180,-145 183.924,-142.118 188.17,-139.262 192.434,-136.548"/>
<polygon fill="black" stroke="black" points="194.426,-139.432 201.111,-131.212 190.759,-133.469 194.426,-139.432"/>
</g>
<!-- proc~lsq&#45;&gt;proc~ddot -->
<g id="edge38" class="edge"><title>proc~lsq&#45;&gt;proc~ddot</title>
<path fill="none" stroke="black" d="M144.275,-189.266C185.296,-174.509 259.243,-147.407 270,-140 289.699,-126.436 285.344,-112.057 306,-100 330.264,-85.8377 361.48,-79.3819 385.564,-76.443"/>
<polygon fill="black" stroke="black" points="386.171,-79.8982 395.742,-75.3558 385.427,-72.9378 386.171,-79.8982"/>
</g>
<!-- proc~lsq&#45;&gt;proc~enforce_bounds -->
<g id="edge40" class="edge"><title>proc~lsq&#45;&gt;proc~enforce_bounds</title>
<path fill="none" stroke="black" d="M135.536,-185.872C138.608,-183.169 141.576,-180.171 144,-177 167.925,-145.701 152.656,-124.36 180,-96 180.917,-95.0492 181.883,-94.1338 182.89,-93.2529"/>
<polygon fill="black" stroke="black" points="185.229,-95.8793 191.25,-87.1619 181.107,-90.2217 185.229,-95.8793"/>
</g>
<!-- proc~lsq&#45;&gt;proc~dcopy -->
<g id="edge44" class="edge"><title>proc~lsq&#45;&gt;proc~dcopy</title>
<path fill="none" stroke="black" d="M144.203,-209.656C181.908,-224.609 247.909,-251.497 270,-265 284.944,-274.135 300.132,-286.558 311.85,-296.971"/>
<polygon fill="black" stroke="black" points="309.606,-299.661 319.362,-303.793 314.312,-294.479 309.606,-299.661"/>
</g>
<!-- proc~lsei -->
<g id="node11" class="node"><title>proc~lsei</title>
<a xlink:href="../proc/lsei.html" xlink:title="lsei">
<polygon fill="#d9534f" stroke="#d9534f" points="252,-213 198,-213 198,-187 252,-187 252,-213"/>
<text text-anchor="middle" x="225" y="-197.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lsei</text>
</a>
</g>
<!-- proc~lsq&#45;&gt;proc~lsei -->
<g id="edge42" class="edge"><title>proc~lsq&#45;&gt;proc~lsei</title>
<path fill="none" stroke="black" d="M144.253,-199.252C157.427,-199.374 173.443,-199.523 187.727,-199.655"/>
<polygon fill="black" stroke="black" points="187.724,-203.155 197.756,-199.748 187.789,-196.155 187.724,-203.155"/>
</g>
<!-- proc~lsei&#45;&gt;proc~dnrm2 -->
<g id="edge26" class="edge"><title>proc~lsei&#45;&gt;proc~dnrm2</title>
<path fill="none" stroke="black" d="M247.613,-213.168C254.829,-217.477 262.807,-222.352 270,-227 286.361,-237.573 288.189,-244.112 306,-252 331.404,-263.25 362.068,-270.104 385.63,-274.091"/>
<polygon fill="black" stroke="black" points="385.157,-277.559 395.584,-275.677 386.259,-270.647 385.157,-277.559"/>
</g>
<!-- proc~lsei&#45;&gt;proc~ddot -->
<g id="edge32" class="edge"><title>proc~lsei&#45;&gt;proc~ddot</title>
<path fill="none" stroke="black" d="M249.539,-186.753C256.388,-182.666 263.681,-177.934 270,-173 287.835,-159.075 287.846,-150.507 306,-137 331.163,-118.278 362.598,-101.673 386.545,-90.2169"/>
<polygon fill="black" stroke="black" points="388.094,-93.3565 395.654,-85.934 385.115,-87.0218 388.094,-93.3565"/>
</g>
<!-- proc~lsei&#45;&gt;proc~dcopy -->
<g id="edge36" class="edge"><title>proc~lsei&#45;&gt;proc~dcopy</title>
<path fill="none" stroke="black" d="M251.864,-213.065C258.279,-216.973 264.774,-221.661 270,-227 292.56,-250.045 286.425,-264.371 306,-290 307.62,-292.12 309.397,-294.242 311.243,-296.311"/>
<polygon fill="black" stroke="black" points="309.075,-299.108 318.513,-303.922 314.137,-294.273 309.075,-299.108"/>
</g>
<!-- proc~h12 -->
<g id="node12" class="node"><title>proc~h12</title>
<a xlink:href="../proc/h12.html" xlink:title="h12">
<polygon fill="#d9534f" stroke="#d9534f" points="630,-203 576,-203 576,-177 630,-177 630,-203"/>
<text text-anchor="middle" x="603" y="-187.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h12</text>
</a>
</g>
<!-- proc~lsei&#45;&gt;proc~h12 -->
<g id="edge28" class="edge"><title>proc~lsei&#45;&gt;proc~h12</title>
<path fill="none" stroke="black" d="M252.423,-207.392C307.688,-221.097 436.038,-246.89 540,-222 551.783,-219.179 563.852,-213.772 574.231,-208.194"/>
<polygon fill="black" stroke="black" points="576.258,-211.068 583.232,-203.092 572.807,-204.978 576.258,-211.068"/>
</g>
<!-- proc~lsi -->
<g id="node13" class="node"><title>proc~lsi</title>
<a xlink:href="../proc/lsi.html" xlink:title="lsi">
<polygon fill="#d9534f" stroke="#d9534f" points="360,-172 306,-172 306,-146 360,-146 360,-172"/>
<text text-anchor="middle" x="333" y="-156.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lsi</text>
</a>
</g>
<!-- proc~lsei&#45;&gt;proc~lsi -->
<g id="edge30" class="edge"><title>proc~lsei&#45;&gt;proc~lsi</title>
<path fill="none" stroke="black" d="M252.253,-189.654C265.555,-184.604 281.754,-178.454 296.142,-172.992"/>
<polygon fill="black" stroke="black" points="297.649,-176.164 305.756,-169.343 295.165,-169.62 297.649,-176.164"/>
</g>
<!-- proc~hfti -->
<g id="node14" class="node"><title>proc~hfti</title>
<a xlink:href="../proc/hfti.html" xlink:title="hfti">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-213 486,-213 486,-187 540,-187 540,-213"/>
<text text-anchor="middle" x="513" y="-197.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">hfti</text>
</a>
</g>
<!-- proc~lsei&#45;&gt;proc~hfti -->
<g id="edge34" class="edge"><title>proc~lsei&#45;&gt;proc~hfti</title>
<path fill="none" stroke="black" d="M252.094,-200C303.769,-200 416.494,-200 475.418,-200"/>
<polygon fill="black" stroke="black" points="475.768,-203.5 485.768,-200 475.768,-196.5 475.768,-203.5"/>
</g>
<!-- proc~lsi&#45;&gt;proc~daxpy -->
<g id="edge18" class="edge"><title>proc~lsi&#45;&gt;proc~daxpy</title>
<path fill="none" stroke="black" d="M340.263,-145.968C351.688,-125.633 374.75,-85.2374 396,-52 399.668,-46.2629 403.783,-40.1632 407.674,-34.5336"/>
<polygon fill="black" stroke="black" points="410.644,-36.3943 413.508,-26.1938 404.908,-32.3822 410.644,-36.3943"/>
</g>
<!-- proc~lsi&#45;&gt;proc~dnrm2 -->
<g id="edge14" class="edge"><title>proc~lsi&#45;&gt;proc~dnrm2</title>
<path fill="none" stroke="black" d="M342.975,-172.301C358.451,-192.934 388.388,-232.851 406.937,-257.582"/>
<polygon fill="black" stroke="black" points="404.18,-259.74 412.98,-265.64 409.78,-255.54 404.18,-259.74"/>
</g>
<!-- proc~lsi&#45;&gt;proc~ddot -->
<g id="edge20" class="edge"><title>proc~lsi&#45;&gt;proc~ddot</title>
<path fill="none" stroke="black" d="M346.19,-145.794C364.47,-127.492 395.354,-96.5832 396,-96 396.83,-95.2502 397.681,-94.494 398.546,-93.736"/>
<polygon fill="black" stroke="black" points="401.13,-96.1343 406.499,-87.0006 396.606,-90.7926 401.13,-96.1343"/>
</g>
<!-- proc~lsi&#45;&gt;proc~h12 -->
<g id="edge12" class="edge"><title>proc~lsi&#45;&gt;proc~h12</title>
<path fill="none" stroke="black" d="M360.222,-160.656C399.893,-163.261 475.854,-168.968 540,-178 548.387,-179.181 557.352,-180.72 565.812,-182.299"/>
<polygon fill="black" stroke="black" points="565.325,-185.77 575.807,-184.225 566.65,-178.896 565.325,-185.77"/>
</g>
<!-- proc~ldp -->
<g id="node15" class="node"><title>proc~ldp</title>
<a xlink:href="../proc/ldp.html" xlink:title="ldp">
<polygon fill="#d9534f" stroke="#d9534f" points="450,-131 396,-131 396,-105 450,-105 450,-131"/>
<text text-anchor="middle" x="423" y="-115.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ldp</text>
</a>
</g>
<!-- proc~lsi&#45;&gt;proc~ldp -->
<g id="edge16" class="edge"><title>proc~lsi&#45;&gt;proc~ldp</title>
<path fill="none" stroke="black" d="M360.003,-146.699C368.292,-142.922 377.557,-138.702 386.377,-134.684"/>
<polygon fill="black" stroke="black" points="388.056,-137.765 395.705,-130.434 385.154,-131.395 388.056,-137.765"/>
</g>
<!-- proc~hfti&#45;&gt;proc~h12 -->
<g id="edge22" class="edge"><title>proc~hfti&#45;&gt;proc~h12</title>
<path fill="none" stroke="black" d="M540.003,-197C548.028,-196.108 556.967,-195.115 565.531,-194.163"/>
<polygon fill="black" stroke="black" points="566.153,-197.616 575.705,-193.033 565.38,-190.659 566.153,-197.616"/>
</g>
<!-- proc~diff -->
<g id="node17" class="node"><title>proc~diff</title>
<a xlink:href="../proc/diff.html" xlink:title="diff">
<polygon fill="#d94e8f" stroke="#d94e8f" points="630,-150 576,-150 576,-124 630,-124 630,-150"/>
<text text-anchor="middle" x="603" y="-134.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">diff</text>
</a>
</g>
<!-- proc~hfti&#45;&gt;proc~diff -->
<g id="edge24" class="edge"><title>proc~hfti&#45;&gt;proc~diff</title>
<path fill="none" stroke="black" d="M531.648,-186.946C544.439,-177.992 561.617,-165.968 575.912,-155.961"/>
<polygon fill="black" stroke="black" points="578.191,-158.639 584.376,-150.037 574.176,-152.904 578.191,-158.639"/>
</g>
<!-- proc~nnls -->
<g id="node16" class="node"><title>proc~nnls</title>
<a xlink:href="../proc/nnls.html" xlink:title="nnls">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-131 486,-131 486,-105 540,-105 540,-131"/>
<text text-anchor="middle" x="513" y="-115.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nnls</text>
</a>
</g>
<!-- proc~ldp&#45;&gt;proc~nnls -->
<g id="edge8" class="edge"><title>proc~ldp&#45;&gt;proc~nnls</title>
<path fill="none" stroke="black" d="M450.003,-118C458.028,-118 466.967,-118 475.531,-118"/>
<polygon fill="black" stroke="black" points="475.705,-121.5 485.705,-118 475.705,-114.5 475.705,-121.5"/>
</g>
<!-- proc~ldp&#45;&gt;proc~diff -->
<g id="edge10" class="edge"><title>proc~ldp&#45;&gt;proc~diff</title>
<path fill="none" stroke="black" d="M450.328,-105.632C474.282,-96.4943 509.882,-87.0627 540,-96 547.926,-98.3519 563.438,-108.419 577.087,-117.988"/>
<polygon fill="black" stroke="black" points="575.083,-120.858 585.259,-123.809 579.144,-115.157 575.083,-120.858"/>
</g>
<!-- proc~nnls&#45;&gt;proc~h12 -->
<g id="edge2" class="edge"><title>proc~nnls&#45;&gt;proc~h12</title>
<path fill="none" stroke="black" d="M529.507,-131.206C543.209,-142.167 562.897,-157.918 578.448,-170.358"/>
<polygon fill="black" stroke="black" points="576.602,-173.364 586.597,-176.878 580.975,-167.898 576.602,-173.364"/>
</g>
<!-- proc~nnls&#45;&gt;proc~diff -->
<g id="edge4" class="edge"><title>proc~nnls&#45;&gt;proc~diff</title>
<path fill="none" stroke="black" d="M540.003,-123.701C548.116,-125.413 557.163,-127.323 565.813,-129.149"/>
<polygon fill="black" stroke="black" points="565.198,-132.597 575.705,-131.238 566.644,-125.748 565.198,-132.597"/>
</g>
<!-- proc~g1 -->
<g id="node18" class="node"><title>proc~g1</title>
<a xlink:href="../proc/g1.html" xlink:title="g1">
<polygon fill="#d9534f" stroke="#d9534f" points="630,-106 576,-106 576,-80 630,-80 630,-106"/>
<text text-anchor="middle" x="603" y="-90.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">g1</text>
</a>
</g>
<!-- proc~nnls&#45;&gt;proc~g1 -->
<g id="edge6" class="edge"><title>proc~nnls&#45;&gt;proc~g1</title>
<path fill="none" stroke="black" d="M540.003,-110.499C548.116,-108.246 557.163,-105.732 565.813,-103.33"/>
<polygon fill="black" stroke="black" points="567.007,-106.631 575.705,-100.582 565.133,-99.8861 567.007,-106.631"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(0.817602 0.817602) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 781,-30 781,5 -4,5"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-26 2.13163e-14,-26 0,-1.24345e-14 54,-3.55271e-15 54,-26"/>
<text text-anchor="middle" x="27" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-26 72,-26 72,-1.24345e-14 138,-3.55271e-15 138,-26"/>
<text text-anchor="middle" x="105" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="210,-26 156,-26 156,-1.24345e-14 210,-3.55271e-15 210,-26"/>
<text text-anchor="middle" x="183" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="292,-26 228,-26 228,-1.24345e-14 292,-3.55271e-15 292,-26"/>
<text text-anchor="middle" x="260" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="364,-26 310,-26 310,-1.24345e-14 364,-3.55271e-15 364,-26"/>
<text text-anchor="middle" x="337" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="436,-26 382,-26 382,-1.24345e-14 436,-3.55271e-15 436,-26"/>
<text text-anchor="middle" x="409" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="590,-26 454,-26 454,-1.24345e-14 590,-3.55271e-15 590,-26"/>
<text text-anchor="middle" x="522" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="662,-26 608,-26 608,-1.24345e-14 662,-3.55271e-15 662,-26"/>
<text text-anchor="middle" x="635" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="776,-26 680,-26 680,-1.24345e-14 776,-3.55271e-15 776,-26"/>
<text text-anchor="middle" x="728" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
     
     
     <h3>Called By</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: proc~~slsqpb~~CalledByGraph Pages: 1 -->
<svg id="procslsqpbCalledByGraph" width="270pt" height="34pt"
 viewBox="0.00 0.00 270.00 34.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~slsqpb~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 30)">
<title>proc~~slsqpb~~CalledByGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 267,-30 267,5 -4,5"/>
<!-- proc~slsqpb -->
<g id="node1" class="node"><title>proc~slsqpb</title>
<polygon fill="none" stroke="black" points="262,-26 208,-26 208,-1.24345e-14 262,-3.55271e-15 262,-26"/>
<text text-anchor="middle" x="235" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">slsqpb</text>
</g>
<!-- proc~slsqp -->
<g id="node2" class="node"><title>proc~slsqp</title>
<a xlink:href="../proc/slsqp.html" xlink:title="slsqp">
<polygon fill="#d9534f" stroke="#d9534f" points="172,-26 118,-26 118,-1.24345e-14 172,-3.55271e-15 172,-26"/>
<text text-anchor="middle" x="145" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">slsqp</text>
</a>
</g>
<!-- proc~slsqp&#45;&gt;proc~slsqpb -->
<g id="edge4" class="edge"><title>proc~slsqp&#45;&gt;proc~slsqpb</title>
<path fill="none" stroke="black" d="M172.003,-13C180.028,-13 188.967,-13 197.531,-13"/>
<polygon fill="black" stroke="black" points="197.705,-16.5001 207.705,-13 197.705,-9.5001 197.705,-16.5001"/>
</g>
<!-- proc~slsqp_wrapper -->
<g id="node3" class="node"><title>proc~slsqp_wrapper</title>
<a xlink:href="../proc/slsqp_wrapper.html" xlink:title="slsqp_wrapper">
<polygon fill="#d9534f" stroke="#d9534f" points="82,-26 4.26326e-14,-26 0,-1.24345e-14 82,-3.55271e-15 82,-26"/>
<text text-anchor="middle" x="41" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">slsqp_wrapper</text>
</a>
</g>
<!-- proc~slsqp_wrapper&#45;&gt;proc~slsqp -->
<g id="edge2" class="edge"><title>proc~slsqp_wrapper&#45;&gt;proc~slsqp</title>
<path fill="none" stroke="black" d="M82.1036,-13C90.5669,-13 99.4334,-13 107.751,-13"/>
<polygon fill="black" stroke="black" points="107.921,-16.5001 117.921,-13 107.921,-9.5001 107.921,-16.5001"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(0.817602 0.817602) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 781,-30 781,5 -4,5"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-26 2.13163e-14,-26 0,-1.24345e-14 54,-3.55271e-15 54,-26"/>
<text text-anchor="middle" x="27" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-26 72,-26 72,-1.24345e-14 138,-3.55271e-15 138,-26"/>
<text text-anchor="middle" x="105" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="210,-26 156,-26 156,-1.24345e-14 210,-3.55271e-15 210,-26"/>
<text text-anchor="middle" x="183" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="292,-26 228,-26 228,-1.24345e-14 292,-3.55271e-15 292,-26"/>
<text text-anchor="middle" x="260" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="364,-26 310,-26 310,-1.24345e-14 364,-3.55271e-15 364,-26"/>
<text text-anchor="middle" x="337" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="436,-26 382,-26 382,-1.24345e-14 436,-3.55271e-15 436,-26"/>
<text text-anchor="middle" x="409" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="590,-26 454,-26 454,-1.24345e-14 590,-3.55271e-15 590,-26"/>
<text text-anchor="middle" x="522" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="662,-26 608,-26 608,-1.24345e-14 662,-3.55271e-15 662,-26"/>
<text text-anchor="middle" x="635" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="776,-26 680,-26 680,-1.24345e-14 776,-3.55271e-15 776,-26"/>
<text text-anchor="middle" x="728" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
     
    <br>
    
    <section>
    <h2>Variables</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-i%7E6"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>i</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-k"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>k</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-j"></span>integer,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>j</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-alfmin"></span>real(kind=wp),</td>
  
  <td>public,</td>
  <td>parameter</td><td>::</td>
  <td><strong>alfmin</strong></td><td> =</td><td>0.1_wp</td><td></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre>    <span class="k">subroutine </span><span class="n">slsqpb</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">meq</span><span class="p">,</span><span class="n">la</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">xl</span><span class="p">,</span><span class="n">xu</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">acc</span><span class="p">,</span><span class="n">iter</span><span class="p">,</span><span class="n">mode</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">x0</span><span class="p">,&amp;</span>
                      <span class="n">mu</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">iw</span><span class="p">,&amp;</span>
                      <span class="n">t</span><span class="p">,</span><span class="n">f0</span><span class="p">,</span><span class="n">h1</span><span class="p">,</span><span class="n">h2</span><span class="p">,</span><span class="n">h3</span><span class="p">,</span><span class="n">h4</span><span class="p">,</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">n3</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">gs</span><span class="p">,</span><span class="n">tol</span><span class="p">,</span><span class="n">line</span><span class="p">,&amp;</span>
                      <span class="n">alpha</span><span class="p">,</span><span class="n">iexact</span><span class="p">,</span><span class="n">incons</span><span class="p">,</span><span class="n">ireset</span><span class="p">,</span><span class="n">itermx</span><span class="p">,</span><span class="n">ldat</span><span class="p">)</span>
    <span class="k">implicit none</span>

<span class="k">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iter</span>  <span class="c">!! **in:**  maximum number of iterations.</span>
                                     <span class="c">!! **out:** actual number of iterations.</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">t</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">f0</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">h1</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">h2</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">h3</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">h4</span>
    <span class="kt">integer</span>  <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">n1</span>
    <span class="kt">integer</span>  <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">n2</span>
    <span class="kt">integer</span>  <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">n3</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">t0</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gs</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tol</span>
    <span class="kt">integer</span>  <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">line</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">alpha</span>
    <span class="kt">integer</span>  <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iexact</span>
    <span class="kt">integer</span>  <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">incons</span>
    <span class="kt">integer</span>  <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ireset</span>
    <span class="kt">integer</span>  <span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">itermx</span>
    <span class="k">type</span><span class="p">(</span><span class="n">linmin_data</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ldat</span> <span class="c">!! data for [[linmin]].</span>

    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iw</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">la</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">meq</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">n</span>

    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span><span class="p">(</span><span class="n">la</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="n">la</span><span class="p">)</span> <span class="p">,</span> <span class="n">g</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">,</span> <span class="n">l</span><span class="p">((</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">mu</span><span class="p">(</span><span class="n">la</span><span class="p">)</span> <span class="p">,</span> <span class="n">r</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="p">,</span> <span class="n">s</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">,</span> <span class="n">u</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">,</span> <span class="n">v</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">w</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">,</span> <span class="n">xl</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">,</span> <span class="n">xu</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">,</span> <span class="n">x0</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">acc</span> <span class="p">,</span> <span class="n">f</span>

<span class="c">!     dim(w) =         n1*(n1+1) + meq*(n1+1) + mineq*(n1+1)  for lsq</span>
<span class="c">!                     +(n1-meq+1)*(mineq+2) + 2*mineq</span>
<span class="c">!                     +(n1+mineq)*(n1-meq) + 2*meq + n1       for lsei</span>
<span class="c">!                      with mineq = m - meq + 2*n1  &amp;  n1 = n+1</span>

    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">alfmin</span> <span class="o">=</span> <span class="mf">0.1_wp</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">mode</span><span class="o">&lt;</span><span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>

          <span class="c">!   call jacobian at current x</span>

          <span class="c">!   update cholesky-factors of hessian matrix by modified bfgs formula</span>

         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">n</span>
            <span class="n">u</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">ddot</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
         <span class="k">end do</span>

         <span class="c">!   l&#39;*s</span>

         <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">n</span>
            <span class="n">h1</span> <span class="o">=</span> <span class="n">zero</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">n</span>
               <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
               <span class="n">h1</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">+</span> <span class="n">l</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">s</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="k">end do</span>
<span class="k">            </span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">h1</span>
         <span class="k">end do</span>

         <span class="c">!   d*l&#39;*s</span>

         <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">n</span>
            <span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">l</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="n">n1</span> <span class="o">-</span> <span class="n">i</span>
         <span class="k">end do</span>

         <span class="c">!   l*d*l&#39;*s</span>

         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">n</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">h1</span> <span class="o">=</span> <span class="n">zero</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
               <span class="n">h1</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">+</span> <span class="n">l</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
               <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="n">n</span> <span class="o">-</span> <span class="n">j</span>
            <span class="k">end do</span>
<span class="k">            </span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">h1</span>
         <span class="k">end do</span>

<span class="k">         </span><span class="n">h1</span> <span class="o">=</span> <span class="n">ddot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">h2</span> <span class="o">=</span> <span class="n">ddot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">h3</span> <span class="o">=</span> <span class="mf">0.2_wp</span><span class="o">*</span><span class="n">h2</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">h1</span><span class="o">&lt;</span><span class="n">h3</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">h4</span> <span class="o">=</span> <span class="p">(</span><span class="n">h2</span><span class="o">-</span><span class="n">h3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">h2</span><span class="o">-</span><span class="n">h1</span><span class="p">)</span>
            <span class="n">h1</span> <span class="o">=</span> <span class="n">h3</span>
            <span class="k">call </span><span class="n">dscal</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">h4</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">call </span><span class="n">daxpy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">one</span><span class="o">-</span><span class="n">h4</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
         <span class="k">end if</span>
<span class="k">         call </span><span class="n">ldl</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="o">+</span><span class="n">one</span><span class="o">/</span><span class="n">h1</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
         <span class="k">call </span><span class="n">ldl</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="o">-</span><span class="n">one</span><span class="o">/</span><span class="n">h2</span><span class="p">,</span><span class="n">u</span><span class="p">)</span>

         <span class="c">!   end of main iteration</span>

         <span class="k">goto </span><span class="mi">200</span>

      <span class="n">elseif</span> <span class="p">(</span> <span class="n">mode</span><span class="o">==</span><span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>

<span class="k">         </span><span class="n">itermx</span> <span class="o">=</span> <span class="n">iter</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">acc</span><span class="o">&gt;=</span><span class="n">zero</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">iexact</span> <span class="o">=</span> <span class="mi">0</span>
         <span class="k">else</span>
<span class="k">            </span><span class="n">iexact</span> <span class="o">=</span> <span class="mi">1</span>
         <span class="k">end if</span>
<span class="k">         </span><span class="n">acc</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">acc</span><span class="p">)</span>
         <span class="n">tol</span> <span class="o">=</span> <span class="n">ten</span><span class="o">*</span><span class="n">acc</span>
         <span class="n">iter</span> <span class="o">=</span> <span class="mi">0</span>
         <span class="n">ireset</span> <span class="o">=</span> <span class="mi">0</span>
         <span class="n">n1</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
         <span class="n">n2</span> <span class="o">=</span> <span class="n">n1</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span>
         <span class="n">n3</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">+</span> <span class="mi">1</span>
         <span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">zero</span>
         <span class="n">mu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">zero</span>
         <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
         <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">mu</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

      <span class="k">else</span>

         <span class="c">!   call functions at current x</span>

         <span class="n">t</span> <span class="o">=</span> <span class="n">f</span>
         <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">m</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">j</span><span class="o">&lt;=</span><span class="n">meq</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">               </span><span class="n">h1</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="k">else</span>
<span class="k">               </span><span class="n">h1</span> <span class="o">=</span> <span class="n">zero</span>
            <span class="k">end if</span>
<span class="k">            </span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">mu</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">h1</span><span class="p">)</span>
         <span class="k">end do</span>
<span class="k">         </span><span class="n">h1</span> <span class="o">=</span> <span class="n">t</span> <span class="o">-</span> <span class="n">t0</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">iexact</span><span class="o">+</span><span class="mi">1</span><span class="o">==</span><span class="mi">1</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            if</span> <span class="p">(</span> <span class="n">h1</span><span class="o">&lt;=</span><span class="n">h3</span><span class="o">/</span><span class="n">ten</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">line</span><span class="o">&gt;</span><span class="mi">10</span> <span class="p">)</span> <span class="k">goto </span><span class="mi">500</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">h3</span><span class="o">/</span><span class="p">(</span><span class="n">two</span><span class="o">*</span><span class="p">(</span><span class="n">h3</span><span class="o">-</span><span class="n">h1</span><span class="p">)),</span><span class="n">alfmin</span><span class="p">)</span>
            <span class="k">goto </span><span class="mi">300</span>
         <span class="n">elseif</span> <span class="p">(</span> <span class="n">iexact</span><span class="o">+</span><span class="mi">1</span><span class="o">==</span><span class="mi">2</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            goto </span><span class="mi">400</span>
         <span class="k">else</span>
<span class="k">            goto </span><span class="mi">500</span>
         <span class="k">end if</span>

<span class="k">      end if</span>

<span class="c">!   reset bfgs matrix</span>

 <span class="mi">100</span>  <span class="n">ireset</span> <span class="o">=</span> <span class="n">ireset</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">ireset</span><span class="o">&gt;</span><span class="mi">5</span> <span class="p">)</span> <span class="k">then</span>
         <span class="c">! check relaxed convergence in case of positive directional derivative</span>
         <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="o">-</span><span class="n">f0</span><span class="p">)</span><span class="o">&lt;</span><span class="n">tol</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">dnrm2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;</span><span class="n">tol</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">h3</span><span class="o">&lt;</span><span class="n">tol</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>
         <span class="k">else</span>
<span class="k">            </span><span class="n">mode</span> <span class="o">=</span> <span class="mi">8</span>
         <span class="k">end if</span>
<span class="k">         return</span>
<span class="k">      else</span>
<span class="k">         </span><span class="n">l</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">zero</span>
         <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span><span class="n">l</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">n</span>
            <span class="n">l</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">one</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="n">n1</span> <span class="o">-</span> <span class="n">i</span>
         <span class="k">end do</span>
<span class="k">      end if</span>

<span class="c">!   main iteration : search direction, steplength, ldl&#39;-update</span>

 <span class="mi">200</span>  <span class="n">iter</span> <span class="o">=</span> <span class="n">iter</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="n">mode</span> <span class="o">=</span> <span class="mi">9</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">iter</span><span class="o">&gt;</span><span class="n">itermx</span> <span class="p">)</span> <span class="k">return</span>

<span class="c">!   search direction as solution of qp - subproblem</span>

      <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">xl</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">xu</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">call </span><span class="n">daxpy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="o">-</span><span class="n">one</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">call </span><span class="n">daxpy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="o">-</span><span class="n">one</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">h4</span> <span class="o">=</span> <span class="n">one</span>
      <span class="k">call </span><span class="n">lsq</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">meq</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">n3</span><span class="p">,</span><span class="n">la</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">iw</span><span class="p">,</span><span class="n">mode</span><span class="p">)</span>

<span class="c">!   augmented problem for inconsistent linearization</span>

      <span class="k">if</span> <span class="p">(</span> <span class="n">mode</span><span class="o">==</span><span class="mi">6</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         if</span> <span class="p">(</span> <span class="n">n</span><span class="o">==</span><span class="n">meq</span> <span class="p">)</span> <span class="n">mode</span> <span class="o">=</span> <span class="mi">4</span>
      <span class="k">end if</span>
<span class="k">      if</span> <span class="p">(</span> <span class="n">mode</span><span class="o">==</span><span class="mi">4</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">m</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">j</span><span class="o">&lt;=</span><span class="n">meq</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">               </span><span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="k">else</span>
<span class="k">               </span><span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">zero</span><span class="p">)</span>
            <span class="k">end if</span>
<span class="k">         end do</span>
<span class="k">         </span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">zero</span>
         <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">h3</span> <span class="o">=</span> <span class="n">zero</span>
         <span class="n">g</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="n">zero</span>
         <span class="n">l</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span> <span class="o">=</span> <span class="n">hun</span>
         <span class="n">s</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="n">one</span>
         <span class="n">u</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="n">zero</span>
         <span class="n">v</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span> <span class="o">=</span> <span class="n">one</span>
         <span class="n">incons</span> <span class="o">=</span> <span class="mi">0</span>
 <span class="mi">250</span>     <span class="k">call </span><span class="n">lsq</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">meq</span><span class="p">,</span><span class="n">n1</span><span class="p">,</span><span class="n">n3</span><span class="p">,</span><span class="n">la</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">iw</span><span class="p">,</span><span class="n">mode</span><span class="p">)</span>
         <span class="n">h4</span> <span class="o">=</span> <span class="n">one</span> <span class="o">-</span> <span class="n">s</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">mode</span><span class="o">==</span><span class="mi">4</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">l</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ten</span><span class="o">*</span><span class="n">l</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span>
            <span class="n">incons</span> <span class="o">=</span> <span class="n">incons</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">incons</span><span class="o">&lt;=</span><span class="mi">5</span> <span class="p">)</span> <span class="k">goto </span><span class="mi">250</span>
            <span class="k">return</span>
<span class="k">         </span><span class="n">elseif</span> <span class="p">(</span> <span class="n">mode</span><span class="o">/=</span><span class="mi">1</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            return</span>
<span class="k">         end if</span>
<span class="k">      </span><span class="n">elseif</span> <span class="p">(</span> <span class="n">mode</span><span class="o">/=</span><span class="mi">1</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         return</span>
<span class="k">      end if</span>

<span class="c">!   update multipliers for l1-test</span>

      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">n</span>
         <span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">ddot</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">end do</span>
<span class="k">      </span><span class="n">f0</span> <span class="o">=</span> <span class="n">f</span>
      <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">gs</span> <span class="o">=</span> <span class="n">ddot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">h1</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">gs</span><span class="p">)</span>
      <span class="n">h2</span> <span class="o">=</span> <span class="n">zero</span>
      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">m</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">j</span><span class="o">&lt;=</span><span class="n">meq</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">h3</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
         <span class="k">else</span>
<span class="k">            </span><span class="n">h3</span> <span class="o">=</span> <span class="n">zero</span>
         <span class="k">end if</span>
<span class="k">         </span><span class="n">h2</span> <span class="o">=</span> <span class="n">h2</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">h3</span><span class="p">)</span>
         <span class="n">h3</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">r</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
         <span class="n">mu</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">h3</span><span class="p">,(</span><span class="n">mu</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">h3</span><span class="p">)</span><span class="o">/</span><span class="n">two</span><span class="p">)</span>
         <span class="n">h1</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">+</span> <span class="n">h3</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
      <span class="k">end do</span>

<span class="c">!   check convergence</span>

      <span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">h1</span><span class="o">&lt;</span><span class="n">acc</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">h2</span><span class="o">&lt;</span><span class="n">acc</span> <span class="p">)</span> <span class="k">return</span>
<span class="k">      </span><span class="n">h1</span> <span class="o">=</span> <span class="n">zero</span>
      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">m</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">j</span><span class="o">&lt;=</span><span class="n">meq</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">h3</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
         <span class="k">else</span>
<span class="k">            </span><span class="n">h3</span> <span class="o">=</span> <span class="n">zero</span>
         <span class="k">end if</span>
<span class="k">         </span><span class="n">h1</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">+</span> <span class="n">mu</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">h3</span><span class="p">)</span>
      <span class="k">end do</span>
<span class="k">      </span><span class="n">t0</span> <span class="o">=</span> <span class="n">f</span> <span class="o">+</span> <span class="n">h1</span>
      <span class="n">h3</span> <span class="o">=</span> <span class="n">gs</span> <span class="o">-</span> <span class="n">h1</span><span class="o">*</span><span class="n">h4</span>
      <span class="n">mode</span> <span class="o">=</span> <span class="mi">8</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">h3</span><span class="o">&gt;=</span><span class="n">zero</span> <span class="p">)</span> <span class="k">goto </span><span class="mi">100</span>

<span class="c">!   line search with an l1-testfunction</span>

      <span class="n">line</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">alpha</span> <span class="o">=</span> <span class="n">one</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">iexact</span><span class="o">==</span><span class="mi">1</span> <span class="p">)</span> <span class="k">goto </span><span class="mi">400</span>

<span class="c">!   inexact linesearch</span>

 <span class="mi">300</span>  <span class="n">line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="n">h3</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">h3</span>
      <span class="k">call </span><span class="n">dscal</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">call </span><span class="n">daxpy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">one</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

      <span class="k">call </span><span class="n">enforce_bounds</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">xl</span><span class="p">,</span><span class="n">xu</span><span class="p">)</span>  <span class="c">! ensure that x doesn&#39;t violate bounds</span>

      <span class="n">mode</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">return</span>

<span class="c">!   exact linesearch</span>

 <span class="mi">400</span>  <span class="k">if</span> <span class="p">(</span> <span class="n">line</span><span class="o">/=</span><span class="mi">3</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">linmin</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="n">alfmin</span><span class="p">,</span><span class="n">one</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">tol</span><span class="p">,</span> <span class="p">&amp;</span>
                         <span class="n">ldat</span><span class="p">%</span><span class="n">a</span><span class="p">,</span> <span class="n">ldat</span><span class="p">%</span><span class="n">b</span><span class="p">,</span> <span class="n">ldat</span><span class="p">%</span><span class="n">d</span><span class="p">,</span> <span class="n">ldat</span><span class="p">%</span><span class="n">e</span><span class="p">,</span> <span class="n">ldat</span><span class="p">%</span><span class="n">p</span><span class="p">,</span>   <span class="n">ldat</span><span class="p">%</span><span class="n">q</span><span class="p">,</span>   <span class="p">&amp;</span>
                         <span class="n">ldat</span><span class="p">%</span><span class="n">r</span><span class="p">,</span> <span class="n">ldat</span><span class="p">%</span><span class="n">u</span><span class="p">,</span> <span class="n">ldat</span><span class="p">%</span><span class="n">v</span><span class="p">,</span> <span class="n">ldat</span><span class="p">%</span><span class="n">w</span><span class="p">,</span> <span class="n">ldat</span><span class="p">%</span><span class="n">x</span><span class="p">,</span>   <span class="n">ldat</span><span class="p">%</span><span class="n">m</span><span class="p">,</span>   <span class="p">&amp;</span>
                         <span class="n">ldat</span><span class="p">%</span><span class="n">fu</span><span class="p">,</span><span class="n">ldat</span><span class="p">%</span><span class="n">fv</span><span class="p">,</span><span class="n">ldat</span><span class="p">%</span><span class="n">fw</span><span class="p">,</span><span class="n">ldat</span><span class="p">%</span><span class="n">fx</span><span class="p">,</span><span class="n">ldat</span><span class="p">%</span><span class="n">tol1</span><span class="p">,</span><span class="n">ldat</span><span class="p">%</span><span class="n">tol2</span> <span class="p">)</span>
         <span class="k">call </span><span class="n">dcopy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
         <span class="k">call </span><span class="n">daxpy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">mode</span> <span class="o">=</span> <span class="mi">1</span>
         <span class="k">return</span>
<span class="k">      end if</span>
<span class="k">      call </span><span class="n">dscal</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="c">!   check convergence</span>

 <span class="mi">500</span>  <span class="n">h3</span> <span class="o">=</span> <span class="n">zero</span>
      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">m</span>
         <span class="k">if</span> <span class="p">(</span> <span class="n">j</span><span class="o">&lt;=</span><span class="n">meq</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">h1</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
         <span class="k">else</span>
<span class="k">            </span><span class="n">h1</span> <span class="o">=</span> <span class="n">zero</span>
         <span class="k">end if</span>
<span class="k">         </span><span class="n">h3</span> <span class="o">=</span> <span class="n">h3</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">h1</span><span class="p">)</span>
      <span class="k">end do</span>

<span class="k">      if</span> <span class="p">(</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="o">-</span><span class="n">f0</span><span class="p">)</span><span class="o">&lt;</span><span class="n">acc</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">dnrm2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;</span><span class="n">acc</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">h3</span><span class="o">&lt;</span><span class="n">acc</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">         </span><span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">else</span>
<span class="k">         </span><span class="n">mode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
      <span class="k">end if</span>

<span class="k">      end subroutine </span><span class="n">slsqpb</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>

    <hr>
    <footer>
        <div class="row">
        <div class="col-md-4">&copy; 2016 </div>
	<div class="col-md-4"><span class="text-center"> slsqp was developed by Jacob Williams</span></div>
        <div class="col-md-4"><span class="pull-right">Documentation generated by <a href="https://github.com/cmacmackin/ford">FORD</a></span></div>
        </div>
        <br>
    </footer>
    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>